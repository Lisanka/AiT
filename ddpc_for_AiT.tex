%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  Sample document for preparing papers to  "Avtomatika i Telemekhanika"
%%  charset=windows-1251
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[12pt]{a&t}
\usepackage{graphicx}

%added by Lizaveta
\newcommand{\bigzero}{\mbox{\normalfont\Large\bfseries 0}}
\newcommand{\rvline}{\hspace*{-\arraycolsep}\vline\hspace*{-\arraycolsep}}
\usepackage{bbm}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\usepackage{float}

%added by Nat
\usepackage{xcolor}


\begin{document}  %%%!!!

\year{2020}
\title{ОПТИМАЛЬНОЕ УПРАВЛЕНИЕ ЛИНЕЙНЫМИ СТАЦИОНАРНЫМИ СИСТЕМАМИ БЕЗ ПРЕДВАРИТЕЛЬНОЙ ПАРАМЕТРИЧЕСКОЙ ИДЕНТИФИКАЦИИ СИСТЕМЫ}
%\thanks{Работа выполнена при финансовой поддержке \dots
%(грант \mbox{№\,\dots}).}

\authors{Н.М.~ДМИТРУК, канд.~физ.-мат.~наук (dmitrukn@bsu.by),\\
Е.А.~МАНЖУЛИНА (fpm.manzhuli@bsu.by)\\
(Белорусский государственный университет, Минск)}
%Т.Т.~ТРЕТИЙ\\
%(место работы, если отличается от места работы Ч.Ч. Четвертого),\\
%Ч.Ч.~ЧЕТВЕРТЫЙ\\
%(место работы, например, Институт проблем управления
%им.~В.А.~Трапезникова РАН, Москва)}

\maketitle

\begin{abstract}
Рассматривается задача оптимального управления линейной стационарной дискретной системой по неточным измерениям ее выходных сигналов при условии гарантированного удовлетворения геометрических ограничений на выходные сигналы. Рассматривается случай, когда минимальная реализация системы в пространстве состояний известна, и случай, когда параметрическая модель системы не известна. Предлагается новый метод решения поставленной задачи в случае неизвестной модели, опирающийся на единственную наблюдаемую траекторию входного и выходного сигнала системы, и позволяющий опустить этап ее параметрической идентификации.
\end{abstract}


\section{Введение}
В современном мире неумолимо возрастает размерность и общая сложность систем управления. Моделирование многих процессов представляется чрезмерно трудоемким, а построенная модель зачастую слишком сложна и громоздка для практического использования. В последние годы все большую популярность набирают методы системного анализа и управления, базирующиеся не на достоверном знании внутренней организации системы (ее модели), но лишь на ее наблюдаемом поведении (измеренных выходных сигналах) \cite{Review}. В западной литературе новые методы получили название data-driven control methods, т.е. методы управления на основе данных. Настоящая работа примыкает к направлению в рамках теории управления на основе данных, истоки которого находятся в так называемой поведенческой (бихевиористской) теории динамических систем, в рамках которой будем опираться в основном на результаты работы \cite{Willems}, согласно которой пространство всех траекторий дискретной линейной стационарной системы порождается сдвигами по времени (и, таким образом, образующих матрицу Ганкеля) записанных в одном единственном процессе наблюдения при условии постоянно возбуждающего входного сигнала, и на развитие этих результатов в \cite{BerberichAllgower} для описания систем в пространстве состояний. В качестве примеров успешного использования результатов \cite{BerberichAllgower} отметим работы по методам стабилизации линейных стационарных систем \cite{BerberichMPC}, \cite{Persis}, \cite{BerberichRobust}, а также одношаговый метод проверки системы на диссипативность \cite{Romer}. Некоторые результаты получены и для нелинейных систем \cite{Coulson}, \cite{Persis}, хотя в этом направлении продвижение не столь велико.

Цель настоящей работы --- исследование задачи оптимального гарантированного управления линейным стационарным динамическим объектом по неточным измерениям выходных сигналов и при наличии ограничений, в формулировке которой собственно модель в явном виде отсутствует, а динамика объекта неявно задается данными априорного наблюдения. При наличии параметрической модели объекта аналогичная задача (для непрерывных систем) исследовалась в работе \cite{Dmitruk2004}, где в режиме реального времени строятся реализации оптимальной обратной связи по измерениям на основе решения ряда задач оптимального наблюдения и управления. Разделимость процесса на наблюдение и управление в рамках подхода на основе данных составляет один из центральных результатов настоящей работы.



\section{Оптимальное гарантированное управление линейной системой}\label{model-based problem}
Рассмотрим линейную дискретную стационарную систему $G$, минимальная реализация  $(A,B,C,D)$ которой известна:
\begin{equation}
    x(t+1) = Ax(t) + Bu(t),  \label{model}
    \end{equation}
$$
    y(t) = Cx(t) + Du(t),
    $$
$$
    t = 0, \ldots, T-1.
    $$
Здесь $x(t) \in \mathbb{R}^n$, $u(t) \in \mathbb{R}^m$, $y(t) \in \mathbb{R}^p$ --- состояние системы, управление и выходной сигнал в момент времени $t$, соответственно. 

Траекторией системы $G$ будем называть пару $\{u, y\} = \{u(t), y(t)\}_{t=0}^{T-1}$ из управления и выходного сигнала,  удовлетворяющую (\ref{model}) при некотором (наблюдателю неизвестном) начальном состоянии $x(0) \in \mathbb{R}^n$.
%Вместо $$\{u(t), y(t)\}_{t=0}^{T-1} = \{(u(0), u(1), \ldots, u(T-1)), (y(0), y(1), \ldots, y(T-1))\},$$ будем зачастую пользоваться более лаконичной записью $\{u_T, y_T\}.$

Относительно начального состояния $x_0$ будем предполагать, что информация о нем ограничивается включением $x(0) \in X_0 = \{ x\in \mathbb{R}^n : x_{\min} \leq x \leq x_{\max} \}$.


На траекторию $\{u,y\}$ наложим ограничения:
\begin{equation} \label{constraints}
    u(t) \in U, \quad y(t) \in Y(t), \quad t = 0, \ldots, T-1,
    \end{equation}
где $U = \{u \in \mathbb{R}^m\ : u_{\min} \leq u \leq u_{\max} \}$ --- множество доступных значений управления,  $Y(t) = \{ y \in \mathbb{R}^p : G(t)y \leq g(t) \}$ --- множество допустимых выходных сигналов,  $G(t) \in \mathbb{R}^{q \times p}$, $g(t) \in \mathbb{R}^q$, $t = 0, \ldots, T-1$.

Поставим задачу о минимизации энергетических затрат на управление системой
\begin{equation}\label{cost}
    J(u) = \sum\limits_{t = 0}^{T-1} \norm{u(t)}^2
    \end{equation}
на множестве доступных управляющих воздействий ${u(t) \in U}$, гарантирующих выполнение ограничений на выходные сигналы (\ref{constraints}) при всех возможных реализациях начального состояния $x_0 \in X_0$:
\begin{align}\label{oc-at-0}
    \min_{u}  \ \ &  \sum_{t=0}^{T-1} ||u(t)||^2, \\
      &   x(t+1) = Ax(t)+Bu(t), \nonumber\\
               &   y(t) = Cx(t)+Du(t), \nonumber\\
               &   u(t)\in U, \ \ y(t) \in  Y(t)\ \
                   \forall x(0)\in X_0, \nonumber\\
               & t=0,1,\ldots, T-1. \nonumber
\end{align}
Поставленная задача решается до начала процесса управления и позволяет дать априорную оценку качества этого процесса.




В каждом конкретном процессе управления реализуется некоторая  траектория $\{u^p, y^p\} = \{u^p(t), y^p(t)\}_{t=0}^{T-1}$ системы $G$, которая определяется  (неизвестным) начальным состоянием $x_0$ и поданным на вход системы  (\ref{model}) управлением $u^p$. Далее будем считать, что в процессе управления доступны лишь неточные измерения выходных сигналов вида
$$
    \tilde{y}^p(t) = y^p(t) + \xi(t), \ \  t = 0, \ldots, T - 1,
     $$
где $\xi(t)$ ---  ошибка измерения в момент времени $t$.
%Верхний индекс $p$ подчеркивает, что измеренные сигналы относятся к конкретной "прошлой"\ (past) траектории.
Величина реализовавшейся ошибка $\xi(t)$ достоверно неизвестна, однако полагаем ее в дальнейшем принадлежащей известному множеству $\Xi = \{ \xi \in \mathbb{R}^p :  ||\xi||_{\infty} \leq \varepsilon \}$, т.е. $\xi(t) \in \Xi$, $t = 0, \ldots, T - 1$.


К некоторому моменту времени $\tau$ пара $\{u^p_\tau, \tilde y^p_\tau\} = \{u^p(t), \tilde y^p(t)\}_{t=0}^{\tau-1}$ из реализовавшихся в рассматриваемом процессе управления и измерений составляет текущую позицию процесса. Она позволяет оценить реализовавшееся начальное состояние, скорректировать будущее управление и улучшить априорную оценку качества процесса управления, которую дает задача (\ref{oc-at-0}).

\begin{definition}\label{def:4-1}
Состояние $x(\tau)$ назовем согласующимся c позицией $\{u_\tau^p, \tilde y_\tau\}$, если найдутся такие допустимые начальное состояние $x_0 \in X_0$ и ошибки измерения $\xi(t) \in \Xi$, $t = 0, \ldots, \tau - 1$, что
$$
    x(\tau) = x(\tau |x_0, u_\tau^p),\ \
    \tilde y(t) = Cx(t | x_0, u_t^p) + Du^p(t) + \xi(t), \ \
    t = 0, \ldots, \tau -1,
    $$
где $x(t|x_0, u_t^p)$ --- состояние, в которое система (\ref{model}) приходит в момент $t$, двигаясь из начальной точки $x(0) = x_0$ под воздействием управления $u_t^p$. 
\end{definition}

Отметим, что начальное состояние $x_0$, о котором идет речь в определении 1, порождает траекторию $\{u_\tau^p, y_\tau\}$, в которой, возможно, $y_\tau \ne y^p_\tau$.

Обозначим через $X(\tau, u_\tau^p, \tilde y_\tau)$ множество всех состояний $x(\tau)$, согласующихся с измеренной траекторией $\{u_\tau^p, \tilde y_\tau\}$.


В момент времени  $\tau$ сформулируем  задачу оптимального  управления:
\begin{align}\label{oc-at-tau}
        \min_{u}  \ \ &  \sum_{t=\tau}^{T-1} ||u(t)||^2, \\
               &   x(t+1) = Ax(t)+Bu(t), \nonumber\\
               &   y(t) = Cx(t)+Du(t), \nonumber\\
               &   u(t)\in U, \ \ y(t) \in  Y(t)\ \
                \forall x(\tau)\in X(\tau, u_\tau^p, \tilde y_{\tau}), \nonumber\\
               & t=\tau,\ldots, T-1. \nonumber
\end{align}


Пусть $u^*(t|\tau, u_\tau^p, \tilde{y}_\tau^p), t = \tau, \ldots, T-1$, --- оптимальное  управление в задаче (\ref{oc-at-tau}). Согласно \cite{Dmitruk2004},  в момент $\tau$  на вход системы $G$ подается  первое значение оптимального управления
$$
    u^p(\tau) = u^*(\tau|\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
после чего в момент $\tau + 1$ решается следующая задача оптимального программного управления (\ref{oc-at-tau}), в которой на единицу уменьшается горизонт планирования и обогащается знание о поведении системы за счет новой позиции $\{u_{\tau+1}^p, \tilde{y}_{\tau+1}^p\}.$

Таким образом, для реализации оптимального гарантированного управления системой $G$ по неточным измерениям ее выходных сигналов при наличии модели системы необходимо в каждый момент $\tau$ решать задачу (\ref{oc-at-tau}). Ee решение основано на принципе разделимости процессов управления и наблюдения (см., к примеру, \cite{SeparationPrinciple}).  Для рассматриваемой задачи можно применить результаты работы  \cite{Dmitruk2004}, модифицируя их с учетом нового типа ограничений и дискретности динамической системы. Соответствующая модификация приводится  в Приложении к данной работе.


\section{Оптимальное гарантированное управление линейной системой на основе данных}
Далее сосредоточимся на задаче управления системой $G$, однако условимся, что реализация $(A,B,C,D)$ системы в пространстве состояний не известна. Классический подход в подобных ситуациях состоит в предварительной идентификации системы и последующей формулировке и решении задачи из разд. 2.

В настоящей работе будет предложен альтернативный подход, не нуждающийся в явном параметрическом представлении системы. Вместо модели $(A,B,C,D)$ будем использовать полученное в \cite{BerberichAllgower} представление любой траектории системы $G$ на основе одной предварительно сгенерированной траектории
$$
    \{u^d, y^d\} = \{u^d(t), y^d(t)\}_{t = 0}^{T^d - 1},
     $$
которую далее будем называть априорной траекторией.


Будем считать, что  априорная траектория $\{u^d, y^d\}$ измерена точно и для системы $G$ дана верхняя оценка размерности ее состояния $n$ (см. \cite{BerberichAllgower}).

%Как и ранее,  траектории "прошлого"\ $${\{(u^p(0), u^p(1), \ldots, u^p(\tau-1)), (y^p(0), y^p(1), \ldots, y^p(\tau-1))\} = \{u_\tau^p, y_\tau^p \}},$$ известные к текущему моменту $\tau$ в процессе управления системой, будем считать измеренными с точностью до ограниченной ошибки: т.е. доступны лишь $\{u_\tau^p, \tilde{y}_\tau^p\}$, где ${\tilde{y}^p_\tau = y^p_\tau + \xi_\tau}$.
%
%В текущий момент времени $\tau$, подобно предыдущему разделу, ставится задача минимизации квадратичного критерия качества
%$$
%    \sum_{t = \tau}^{T-1} \norm{u(t)}^2,
%    $$
%при гарантированном соблюдении линейных условий
%$$
%    G(t)y(t) \leq g(t), \quad u_{\min} \leq u(t) \leq u_{\max}, \quad \tau \leq t \leq T-1,
%    $$
%на входные и выходные сигналы.


\subsection{Информативность априорной траектории}
Предварительно приведем результаты работ \cite{ }, в которых показано, как априорная траектория $\{u^d, y^d\}$ при определенных условиях может иметь ту же информационную ценность, что и модель системы $(A,B,C,D)$.

\begin{definition}\label{persistency exciting}
Пусть {\color{blue} $L,L^d \in \mathbb{N}$, $L \leq L^d$}. Управление $u = \{u(t)\}_{t=0}^{L^d-1}$ называется постоянно возбуждающим порядка $L$, если соответствующая матрица Ганкеля
$$
H_L(u) =
\begin{pmatrix}
  u(0) & u(1) & \cdots & u(L^d-L)\\
  u(1) & u(2) & \cdots & u(L^d-L+1)\\
  \vdots & \vdots & \ddots & \vdots \\
  u(L-1) & u(L) & \cdots & u(L^d-1)
\end{pmatrix}
$$
имеет полный строчный ранг.
\end{definition}

\begin{remark}\label{remark on input length}
Если управление $u$ является постоянно возбуждающим порядка $L$, то оно должно быть достаточно длинным. Поскольку матрица $H_L(u)\in \mathbb{R}^{mL \times (L^d - L + 1)}$ имеет полный строчный ранг, число строк не   превышает число столбцов: $L^d - L + 1 \geq mL$. Отсюда следует необходимое условие на длину $L^d$ постоянно возбуждающего управления порядка $L$: $L^d \geq L(m+1) - 1$.
\end{remark}

Согласно \cite{Willems}, \cite{BerberichAllgower}, траектория, порожденная постоянно возбуждающим управлением достаточно высокого порядка, содержат информацию, достаточную для представления любой траектории системы $G$. Далее будем использовать следующий результат работы \cite{Willems}, сформулированный в \cite{BerberichAllgower} в терминах  классических моделей в пространстве состояний:
\begin{theorem}\label{trajectory check}
Пусть $\{u^d, y^d\} = {\color{blue}\{u^d(t), y^d(t)\}_{t=0}^{T^d-1} }$ --- априорная траектория линейной системы $G$ размерности $n$, причем $u^d$ --- постоянно возбуждающее управление порядка $T+n$. Тогда $\{u, y\} = \{u(t), y(t)\}_{t=0}^{T-1}$ является траекторией $G$ в том и только в том случае, когда для
\begin{equation}
\begin{pmatrix}
H_T(u^d) \\
H_T(y^d)
\end{pmatrix} \alpha = \begin{pmatrix}
u \\
y
\end{pmatrix}
\end{equation}
существует решение $\alpha \in \mathbb{R}^{T^d-T+1}.$
\end{theorem}

Теорема \ref{trajectory check} позволяет проверять любую пару $\{u,y\}$ на принадлежность множеству траекторий системы $G$. 
В дальнейшем будем использовать условия теоремы для построения множества возможных траекторий $\{u^p_\tau, u, y^p_\tau, y\}$ длины $T$ с некоторой фиксированной "прошлой"\ частью $\{u^p_\tau, y^p_\tau\}$ длины $\tau$ и нефиксированной "будущей"\ частью  $\{u, y\} = \{u(t), y(t)\}_{t=\tau}^{T-1}$. Для этого будем делить на "прошлое"\ и "будущее"\ для момента $\tau$ и строки матриц Ганкеля для априорной траектории
\begin{equation}
H_T(u^d) = \begin{pmatrix}
  u^d(0) & \cdots & u^d(T^d-T)\\
  \vdots & \ddots & \vdots \\
  u^d(\tau-1) & \cdots & u^d(\tau-1 + T^d - T) \\
  \hline
  u^d(\tau) & \cdots & u^d(\tau + T^d-T)\\
  \vdots & \ddots & \vdots \\
  u^d(T-1) & \cdots & u^d(T^d-1)
\end{pmatrix} =
		\begin{pmatrix}
		U_{\tau}^p \\
		U_{\tau}^f
		\end{pmatrix},
\end{equation}
\begin{equation}
H_T(y^d) = \begin{pmatrix}
  y^d(0) & \cdots & y^d(T^d-T)\\
  \vdots & \ddots & \vdots \\
  y^d(\tau-1) & \cdots & y^d(\tau-1 + T^d - T) \\
  \hline
  y^d(\tau) & \cdots & y^d(\tau + T^d-T)\\
  \vdots & \ddots & \vdots \\
  y^d(T-1) & \cdots & y^d(T^d-1)
\end{pmatrix} =
		\begin{pmatrix}
		Y_{\tau}^p \\
		Y_{\tau}^f
		\end{pmatrix}.
\end{equation}

%{\color{red} Нам это нужно для чего-то?} Поэтому для построения возможных траекторий можно воспользоваться следующим алгоритмом:\\
%1. Зафиксировать интересующее значение "будущего"\ входного сигнала $u$.\\
%2. Для выбранного $u$ найти некоторое решение $\alpha \in \mathbb{R}^{T^d-T+1}$ системы линейных алгебраических уравнений
%\begin{equation}
%\begin{pmatrix}
%U_{\tau}^p \\
%Y_{\tau}^p \\
%U_{\tau}^f
%\end{pmatrix} \alpha = \begin{pmatrix}
%u_{\tau}^p \\
%y_{\tau}^p \\
%u
%\end{pmatrix}.
%\end{equation}
%3. Вычислить $y = Y_{\tau}^f \alpha$. Получили одну из возможных
%траекторий для фиксированных $u^p_\tau, y^p_\tau, u$.

Если управление $u^d$ является постоянно возбуждающим порядка $T+n$, то, согласно теореме \ref{trajectory check}, $\{u_{\tau}^p, u, y_{\tau}^p, y\}$ является траекторией системы $G$ тогда и только тогда, когда уравнение
\begin{equation}\label{traj-cond}
\begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f \\
Y_{\tau}^f
\end{pmatrix} \alpha = \begin{pmatrix}
u_{\tau}^p \\
y_{\tau}^p \\
u \\
y
\end{pmatrix}
\end{equation}
имеет решение $\alpha(\tau)\in \mathbb{R}^{T^d - T +1}$.

В силу теоремы \ref{trajectory check}, для любых $u^p_\tau, y^p_\tau, u$ можно найти хотя бы одну возможную выходную траекторию $y$, но для единственности $y$, которая представляет особый практический интерес, нужно наложить дополнительные условия. Поскольку для линейной системы размерности $n$ траектория длины $n$ однозначно определяет начальное состояние, то для обеспечения единственности достаточно потребовать $\tau \geq n$. Потому в дальнейшем полагаем, что управление начинается в момент $n$, --- это своего рода неявный аналог явного ограничения $x(0) \in X_0$ в постановке задачи при известной модели.


%Вместо явного задания динамики системы моделью $(A,B,C,D)$ в пространстве состояний, будем пользоваться неявным описанием  поведения системы в виде (\ref{traj-cond}). Начальное состояние системы также фиксируем неявно, начиная управление в момент $n$.
%
%Таким образом, в каждый момент времени $n \leq \tau \leq T$ решаем следующую задачу оптимального программного управления, обладая неточной траекторией $\{u_\tau^p, \tilde{y}_\tau^p\}$:
%\begin{equation}\label{dd-oc-at-tau}
%\min\limits_{u} u^Tu,
%\end{equation}
%$$
%\begin{pmatrix}
%U_\tau^p \\
%Y_\tau^p \\
%U_\tau^f \\
%\end{pmatrix} \alpha = \begin{pmatrix}
%u_\tau^p \\
%y_\tau^p \\
%u \\
%\end{pmatrix},
%$$
%$$
%\tilde{y}_\tau^p = y_\tau^p + \xi_\tau, \quad -\varepsilon\mathbbm{1} \leq \xi_\tau \leq \varepsilon \mathbbm{1},
%$$
%$$u_{\min}(\tau) \leq u \leq u_{\max}(\tau),$$
%$$
%G_\tau Y_\tau^f \alpha \leq g_\tau \quad \forall \alpha, \xi_\tau,
%$$

\subsection{Принцип разделимости}
Найдем аналог принципа разделимости управления и наблюдения для линейных систем, реализация которых $(A,B,C,D)$ известна,   для случая, когда траектория системы $G$ представлена в виде (\ref{traj-cond}). Будем следовать идее декомпозиции выходного сигнала $y$ (см. Приложение)
\begin{equation}\label{DBOC-y-separation}
    y =  y_0 + \hat y.
    \end{equation}
Здесь $y_0 = \{y_0(t)\}_{t=\tau}^{T-1}$ --- выходной сигнал системы $G$, соответствующий управлению $u$ и тривиальному начальному условию $x(\tau) = 0$, т.е. $\{u,y_0\}$ --- траектория системы $G$ при $t = \tau, \ldots, T-1$. Выходной сигнал $\hat y = \{\hat y(t)\}_{t=\tau}^{T-1}$ соответствует возможным будущим выходным сигналам системы $G$ с тривиальным управлением при $t = \tau, \ldots, T-1$, согласующимся с позицией $\{u^p, y_\tau^p\}$, т.е. $\{0,\hat y\}$ --- траектория системы $G$ c начальным условием {\color{red} $x(\tau) \in X(\tau, u_\tau^p, \tilde y_{\tau}^p)$ было это записано,но в Лемме 1 будет идти речь про точно измеренные траектории $y_{\tau}^p$, состыковку с ними, поэтому заменила на записанное синим:} {\color{blue} $x(\tau)$ из множества состояний, в которые система могла прийти, точно следуя траектории $\{u^p, y_\tau^p\}$.}

%{\color{red} Тогда можно продолжить, что по необходимости теоремы $\exists \alpha_0(\tau), \hat \alpha(\tau)$ удовлетворяющее (12). Тогда по достаточности $\{u_{\tau}^p, u, y_{\tau}^p, \hat{y} + y_0\}$ --- траектория системы и любую траекторию можно строить согласно лемме, сформулированной ниже.}
Состояние $x(\tau)=0$ можно зафиксировать неявно посредством траектории $\{0,0\}$ входных и выходных сигналов. С такой траекторией, очевидно, согласуется начальное условие $x(0)=0$, а поскольку мы условились, что длина траектории $\tau \geq n$, это единственно возможное начальное состояние. Тогда и все последующие состояния $x(1)=0, \ldots$ вплоть до $x(\tau)=0$.

Из необходимого условия теоремы \ref{trajectory check} следует, что для траекторий $\{0, u, 0, y_0\}$ и $\{u_{\tau}^p, 0, y_{\tau}^p, \hat{y}\}$ существуют $ \alpha_0(\tau), \hat \alpha(\tau)$ соответственно, удовлетворяющие
\begin{equation}\label{two traj}
\begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f \\
Y_{\tau}^f
\end{pmatrix} \alpha_0(\tau) = \begin{pmatrix}
0 \\
0 \\
u \\
y_0
\end{pmatrix},
 \quad
 \begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f \\
Y_{\tau}^f
\end{pmatrix} \hat{\alpha}(\tau) = \begin{pmatrix}
u_{\tau}^p \\
y_{\tau}^p \\
0 \\
\hat{y}
\end{pmatrix}.
\end{equation}
 Сложив два равенства  (\ref{two traj}), получаем
\begin{equation}\label{one traj}
\begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f \\
Y_{\tau}^f
\end{pmatrix} (\hat{\alpha}(\tau) + \alpha_0(\tau)) = \begin{pmatrix}
u_{\tau}^p \\
y_{\tau}^p \\
u \\
\hat{y} + y_0
\end{pmatrix}.
\end{equation}
В силу теоремы \ref{trajectory check}, условие (\ref{one traj}) является достаточным для того, чтобы ${\{u_{\tau}^p, u, y_{\tau}^p, \hat{y} + y_0\}}$ являлась траекторией системы. Поскольку начальное состояние $x_0$ неявно зафиксировано достаточно длинным участком $\{u_{\tau}^p, y_{\tau}^p\}$, эта траектория совпадает с искомой $\{u_{\tau}^p, u, y_{\tau}^p, y\}$, т.е. $y = \hat{y} + y_0$. Таким образом, любую траекторию можно строить согласно лемме, сформулированной ниже.

\begin{lemma}\label{dd-separation}
Пусть $\{u_{\tau}^p, y_{\tau}^p \}$ --- некоторая фиксированная траектория системы $G$ длины $\tau \geq n$. Тогда любая траектория $\{u_{\tau}^p, u, y_{\tau}^p, y\}$ длины $T$ системы $G$ однозначно представима в виде суммы траекторий $\{0, u, 0, y_0\}$ и $\{u_{\tau}^p, 0, y_{\tau}^p, \hat{y}\}$ длины $T$, причем для фиксированного $u$ определить неизвестные участки $y_0, \hat{y}$ можно следующим образом:\\
1. Найти некоторые решения $\hat{\alpha}, \alpha_0$ алгебраичеких уравнений
\begin{equation}
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
\end{pmatrix} \hat{\alpha} = \begin{pmatrix}
u_\tau^p \\
y_\tau^p \\
0 \\
\end{pmatrix}, \quad
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
\end{pmatrix} \alpha_0 = \begin{pmatrix}
0 \\
0 \\
u \\
\end{pmatrix}.
\end{equation}
2. Вычислить $\hat{y} = Y_\tau^f\hat{\alpha}, \quad y_0 = Y_\tau^f\alpha_0$.
\end{lemma}

{\color{blue}
\begin{remark}\label{y(t)-from-y}
Для получения $\hat y(t), y_0(t)$ в конкретный момент времени, на шаге 2 необходимо использовать соответствующий блок $Y_\tau^f(t)$ матрицы $Y_\tau^f$:\\ 
$Y_\tau^f(t) = (y^d(t), y^d(t+1), \ldots, y^d(t+T^d-T))$. Получим $\hat y(t) = Y_\tau^f(t) \hat \alpha$, $y_0(t) = Y_\tau^f(t) \alpha_0$.
\end{remark}
}

{\color{red}Определение, предложенное Вами}
{\color{blue}
\begin{definition} Назовем параметр $\hat\alpha(\tau)$ согласующимся с прошлой траекторией $\{u^p_\tau, \tilde y_\tau^p\}$ если
\begin{equation}\label{DBOC-hat-alpha}
    \begin{pmatrix}
        U_\tau^p \\
        Y_\tau^p \\
        U_\tau^f \\
        \end{pmatrix} \hat{\alpha}(\tau) = \begin{pmatrix}
        u_\tau^p \\
        y_\tau^p \\
        0 \\
        \end{pmatrix}, \ \
    ||y^p(t) - \tilde y^p(t)||_{\infty} \le \varepsilon, \ \
     t = 0, \ldots, \tau-1.
\end{equation}
\end{definition}

Пусть ${\cal A}(\tau, u_\tau^p, \tilde y_{\tau}^p)$ --- множество всех $\hat \alpha(\tau)$, согласующихся с  $\{u^p_\tau, \tilde y^p_\tau\}$:
\begin{align*}
    {\cal A}(\tau, u_\tau^p, \tilde y^p_\tau) = \bigg\{ \hat \alpha(\tau)\in \mathbb{R}^{T^d-T+1} : & \ \  U_\tau^p\hat{\alpha}(\tau) = u^p_\tau,  \ \ U^f_\tau\hat{\alpha}(\tau) = 0, &\\
    & -\varepsilon \mathbbm{1} \le Y^p_\tau\hat{\alpha}(\tau) -\tilde y^p_\tau \le  \varepsilon\mathbbm{1}\bigg\}, &
    \end{align*}
где $\mathbbm{1}$ --- $m(T-\tau)$-вектор из единиц.
Очевидно, что множество ${\cal A}(\tau, u_\tau^p, \tilde y^p_\tau)$ --- аналог множества $X(\tau, u_\tau^p, \tilde y^p_\tau)$ состояний $x(\tau)$ согласующихся с измеренной траекторией $\{u_\tau^p, \tilde y^p_\tau\}$.
}


Далее, определим ${\cal Y}(t, \tau, u_\tau^p, \tilde y^p_\tau)$ как множество всех возможных $\hat y(t)$ при фиксированных $\{u^p_\tau, \tilde y^p_\tau\}$. В соответствии с замечанием \ref{y(t)-from-y}, это множество порождается множеством ${\cal A}(\tau, u_\tau^p, \tilde y_{\tau}^p)$:
\begin{align*}
    {\cal Y}(t, \tau, u_\tau^p, \tilde y^p_\tau) = \bigg\{ Y_\tau^f(t) \hat \alpha(\tau) : & \ \  \hat \alpha(\tau) \in {\cal A}(\tau, u_\tau^p, \tilde y^p_\tau)\bigg\}. &
    \end{align*}
    
В связи с вышеизложенной идеей декомпозиции выходного сигнала, ограничение на них принимает вид
$G(t)(y_0(t)+\hat y(t)) \leq g(t)$.

Наложим на $y_0(t)$ суженное условие:
\begin{equation}\label{tightened constraint}
G(t)y_0(t) \leq g(t)-\chi(t|\tau),
\end{equation}
где каждое $\chi(t|\tau)$ соответствует наихудшей реализации состояния системы в момент $\tau$, а именно, каждый его элемент $\chi_i(t|\tau)$ является решением задачи 

\begin{equation} \label{estimation-set-description}
\chi_i(t|\tau) = \max\limits_{\hat{y}(t)} G_i(t)\hat{y}(t),
\end{equation}
$$\hat{y}(t) \in {\cal Y}(t, \tau, u_\tau^p, \tilde y_{\tau}^p)$$

С учетом определений множества ${\cal Y}(t, \tau, u_\tau^p, \tilde y_{\tau}^p)$ и порождающего его ${\cal A}(\tau, u_\tau^p, \tilde y_{\tau}^p)$, задача (\ref{estimation-set-description}) представляет собой следующую задачу линейного программирования:
\begin{equation} \label{estimation-lp}
\chi_i(t|\tau) = \max\limits_{\hat{\alpha(\tau)}} G_i(t)Y_{\tau}^f(t)\hat{\alpha}(\tau),
\end{equation}
$$\begin{pmatrix}
U_\tau^p \\
U_\tau^f \\
\end{pmatrix} \hat{\alpha}(\tau) = \begin{pmatrix}
u_\tau^p \\
0 \\
\end{pmatrix},
$$
$$
\tilde{y}_{\tau}^p-\varepsilon \mathbbm{1} \leq
Y_\tau^p \hat{\alpha}(\tau) \leq
\tilde{y}_\tau^p + \varepsilon \mathbbm{1}.
$$

Выполнение  для $y_0(t)$ суженного ограничения (\ref{tightened constraint}) очевидно влечет удовлетворение исходного ограничения на $y(t)$ для любой возможной реализации $\hat{y}(t)$.

Детерминированная задача оптимального программного управления с суженными условиями на $y_0$ принимает следующий вид:

\begin{equation}\label{control}
\min\limits_{\alpha_0(\tau), u}{\color{blue}\norm{u}^2},
\end{equation}
$$\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
\end{pmatrix} \alpha_0(\tau) = \begin{pmatrix}
0 \\
0 \\
u \\
\end{pmatrix},$$
$$G(t)Y_{\tau}^f(t)\alpha_0(\tau) \leq g(t) - \chi(t|\tau),$$
$$u_{\min} \leq u \leq u_{\max}.$$


Снова переходим к эквивалентному виду (исключая $u$) получаем
\begin{equation}\label{control-qp}
\min\limits_{\alpha_0(\tau)}\alpha_0(\tau)^T{U_{\tau}^f}^TU_{\tau}^f\alpha_0(\tau),
\end{equation}
$$
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
\end{pmatrix} \alpha_0(\tau) = \begin{pmatrix}
0 \\
0 \\
\end{pmatrix},
$$
$$G(t)Y_{\tau}^f(t)\alpha_0(\tau) \leq g(t)- \chi(t|\tau),$$
$$u_{\min} \leq U_{\tau}^f\alpha_0(\tau) \leq u_{\max}.$$
Получив решение $\alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)$ задачи  (\ref{control-qp}), вычисляем оптимальное управление ${u^*(\tau, u_\tau^p, \tilde{y}_\tau^p) = U_\tau^f \alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)}$. Из вычисленного ${u^*(\tau, u_\tau^p, \tilde{y}_\tau^p) = (u^*(\tau|\tau, u_\tau^p, \tilde{y}_\tau^p), \ldots, u^*(T-1|\tau, u_\tau^p, \tilde{y}_\tau^p))}$ подаем на вход системе ${u^p(\tau) := u^*(\tau|\tau, u_\tau^p, \tilde{y}_\tau^p).}$ Переходим к решению задач (\ref{estimation-lp}), а затем и задачи (\ref{control-qp}), в момент $\tau+1$, зная траекторию $\{u^p_{\tau+1}, \tilde{y}^p_{\tau+1}\}$. Если существовало допустимое воздействие в момент $\tau$, то гарантированно существует допустимое воздействие в момент $\tau + 1$, причем значение критерия качества на каждом шагу не увеличивается.
{\color{red}TODO: Тут про recursive feasibility вставить}

\bigskip
Таким образом, задача оптимального управления, решаемая в каждой временной точке $n \leq \tau \leq T-1$, свелась к ряду задач линейного программирования и одной выпуклой задаче квадратичного программирования.

\section{Численный пример}
{\color{red} TODO: Тут вставлю примеры новые}

Применим изложенный метод для управления следующей системой размерности $n = 3$ с одним входом и одним выходом:
$$x(t+1) = \begin{pmatrix}
0.8639 & 0.3075 & -0.2086 \\
-0.146 & 0.9265 & 0.245 \\
-0.1715 & -0.2195 & 1\\
\end{pmatrix}
x(t) + \begin{pmatrix}
0.1239 \\
-0.0847 \\
0.1602\\
\end{pmatrix}u(t),$$
$$y(t) = \begin{pmatrix}
0.3 & 1.5 & -0.7 \\
\end{pmatrix}x(t) + \begin{pmatrix}
-1.4
\end{pmatrix}u(t), \quad t= 0, \ldots, T-1,$$
минимизируя критерий качества $\sum_{t=0}^{T-1}\norm{u(t)}^2$ при гарантированном соблюдении ограничений $-1 \leq u(t) \leq 1, \quad -1 \leq y(t) \leq 1, \quad t = n, \ldots, T-1.$
Момент начала управления такой же, как и размерность системы $n = 3$ --- этого достаточно для неявного задания начального условия $x_0.$ Горизонт планирования $T = 120.$

Как было отмечено в Замечании \ref{lower bound on T^d}, длина априорной траектории $T^d$ должна быть не меньше $(n + T)(m + 1) - 1$, что в нашем случае, при $n = 3, m = 1$, означает $T^d \geq 2(3+T) - 1 = 245.$ Именно такой, наименьшей подходящей длины, была предварительно сгенерирована зашумленная траектория $\{u^d, \tilde{y}^d\}.$ Входные сигналы были сгенерированы как случайные числа, равномерно распределенные в $[-1, 1]$, а ошибки, добавляемые к "чистой"\ выходной траектории $y^d$, --- как случайные числа, равномерно распределенные в $[-\varepsilon, \varepsilon], \quad \varepsilon = 0.002.$

После таким же образом была сгенерирована траектория $\{u^p_3, \tilde{y}^p_3\}$, соответствующая движению системы до начала управления:
$$u_3^p = \begin{pmatrix}
   0.11004849  \\
   0.59704522  \\
   0.43059520
\end{pmatrix},
y_3^p = \begin{pmatrix}
  0.70244403  \\
  -0.07057178 \\
   0.07171414
\end{pmatrix}.
$$
Ниже приведены управление, выход и фазовая траектория, полученные в результате применения предложенного метода.

\begin{figure}[H]
\centering
%\includegraphics[scale = 0.9]{ufinal.eps}
\caption{\ }
\end{figure}
Значение критерия качества составляет $2.84904042$ на первой итерации, $2.60124510$ --- на последней.

\begin{figure}[H]
\centering
%\includegraphics[scale = 0.9]{yfinal.eps}
\caption{\ }
\end{figure}

На рис. \ref{phase} точкой $\circ$ отмечено начальное положение, а звездочкой *~--- конечное положение траектории.
\begin{figure}[H]
\centering
%\includegraphics[scale= 0.9]{xfinal.eps}
\caption{\ }
\label{phase}
\end{figure}


\section{Заключение}
В данной работе был предложен новый способ решения задачи оптимального управления линейной стационарной системой по неточным выходным сигналам при гарантированном соблюдении наложенных на выходные сигналы ограничений. Этот способ не требует знания реализации системы в пространстве состояний. Предложенный метод сводится к решению задач линейного и квадратичного программирования, базирующихся лишь на двух траекториях системы: априорной и наблюдаемой в процессе управления.

Задача решена в предположении, что траектория, измеряемая в процессе управления, неточна, но априорная траектория известна точно. Было предложено дальнейшее направление исследования: случай, когда априорная траектория также зашумлена.

\appendix{}
Метод решения задачи (\ref{oc-at-tau}) из раздела \ref{model-based problem}, предложенный в \cite{Dmitruk2004}

Итак, в каждый момент времени $\tau = 0, \ldots, T-1$, обладая знанием неточной траектории $\{u_\tau^p, \tilde{y}_\tau^p\}$,  решаем следующую задачу оптимального программного управления:
\begin{equation}\label{oc-at-tau-app}
    \min\limits_u \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,
    \end{equation}
$$
    x(t+1) = Ax(t) + Bu(t),
    $$
$$
    y(t) = Cx(t) + Du(t),
    $$
$$
    u(t) \in U, \quad
    y(t) \in Y(t) \quad \forall x(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
$$
    t = \tau, \ldots, T-1.
    $$

Воспользовавшись принципом разделимости процессов управления и наблюдения для линейных систем, разделяем решение задачи (\ref{oc-at-tau-app}) на решение ряда задач оптимального наблюдения и одной задачи детерминированного оптимального управления.

Так, представив состояние $x(t)$ и выходной сигнал $y(t)$ в виде $x(t) = x_0(t) + \hat{x}(t),$ $y(t) = y_0(t) + \hat{y}(t)$, где $x_0(t), y_0(t)$ соответствуют состоянию и выходу номинальной системы с тривиальным начальным состоянием
$$
    x_0(t+1) = Ax_0(t) + Bu(t), \quad x_0(\tau) = 0,
    $$
$$
    y_0(t) = Cx_0(t) + Du(t), \quad t = \tau, \ldots, T-1,
    $$
а $\hat{x}(t), \hat{y}(t)$ соответствуют состоянию и выходу неуправляемой системы с неопределенным начальным состоянием
$$
    \hat{x}(t) = A\hat{x}(t), \quad \hat{x}(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
$$
    \hat{y}(t) = C\hat{x}(t), \quad t = \tau, \ldots, T-1,
    $$
можем рассмотреть ограничение на выходные сигналы (\ref{constraints}) в виде
$$
    G(t)(y_0(t) + \hat{y}(t)) \leq g(t), \quad \forall x(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
что влечет естественное суженное условие на $y_0(t)$, удовлетворение которого будет гарантировать допустимость выходного сигнала $y(t)$:
\begin{equation}\label{model-chi}
    y_0(t) \in Y_0(t | \tau) = \{y \in \mathbb{R}^p : G(t)y \leq g(t) - \chi(t|\tau)\},
    \end{equation}
где каждая компонента вектора $\chi(t | \tau)$ соответствет наихудшей реализации состояния $x(\tau)$:
\begin{equation}
    \chi_i(t | \tau) = \max\limits_z G_i(t)\hat{y}(t),
    \end{equation}
$$
    \hat{x}(s+1) = A\hat{x}(s), \quad \hat{x}(\tau) = z,
    $$
$$
    y(s) = C\hat{x}(s), \quad s = \tau, \ldots, t,
    $$
$$
    z \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
где $G_i(t)$ обозначает $i$--ю строку матрицы $G(t).$

После вычисления всех оценок $\chi(t|\tau), \quad t = \tau, \ldots, T-1$, оптимальное управление $u^*(t|\tau, u_\tau^p, \tilde{y}_\tau^p)$ получаем как решение следующей детерминированной задачи оптимального управления:
\begin{equation}\label{model-det-oc}
\min\limits_u \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,
\end{equation}
$$
    x_0(t+1) = Ax_0(t) + Bu(t), \quad x_0(\tau) = 0,
    $$
$$
    y_0(t) = Cx_0(t) + Du(t),
    $$
$$
    u(t) \in U, \quad y_0(t) \in Y_0(t | \tau),
    $$
$$
    t = \tau, \ldots, T-1.
    $$

\begin{thebibliography}{10}
\bibitem{Dmitruk2004}
{\it Габасов Р., Дмитрук Н.М., Кириллова Ф.М.} Оптимальное управление многомерными системами по неточным измерениям их выходных сигналов // Труды Института математики и механики УрО РАН. 2004  Т. 10. № 2. С. 33--57.

\bibitem{BerberichAllgower}
{\it Berberich J., Allg{\"o}wer F.} A trajectory-based framework for data-driven system analysis and control //
arXiv: 1903.10723. 2019.

\bibitem{BerberichRobust}
{\it Berberich J., Romer A., Scherer C. W., Allg{\"o}wer F.} Robust data-driven state-feedback design //
arXiv: 1909.04314. 2019.

\bibitem{BerberichMPC}
{\it Berberich J., K{\"o}hler J., M{\"u}ller M. A., Allg{\"o}wer F.} Data-Driven Model Predictive Control with Stability and Robustness Guarantees //
arXiv: 1906.04679. 2019.

\bibitem{Copp}
{\it Copp D., Hespanha J.} Simultaneous nonlinear model predictive control and state estimation //
Automatica. 2016. V. 77. P. 143--154.

\bibitem{Coulson}
{\it Coulson J., Lygeros J., D{\"o}rfler F.} Data-Enabled Predictive Control: In the Shallows of the DeePC //
18th European Control Conference (ECC), Naples, Italy. 2019. P. 307--312.

\bibitem{SeparationPrinciple}
{\it Kurzhanskii A. B., V\'{a}lyi I.}
Ellipsoidal calculus for estimation and control. Nelson Thornes, 1997

\bibitem{Persis}
{\it De Persis C., Tesi P.} Formulas for data--driven control: Stabilization, optimality and robustness //
arXiv: 1903.06842. 2019.

\bibitem{Romer}
{\it Romer A., Berberich J., K{\"o}hler J., Allg{\"o}wer F.} One--shot verification of dissipativity properties from input--output data //
IEEE Control Systems Letters. 2019. V. 3, No.3. P. 709--714.

\bibitem{Waarde}
{\it Waarde H. J., Eising J., Trentelman H. L., Camlibel M. K.} Data informativity: a new perspective on data-driven analysis and control //
arXiv: 1908.00468. 2019.

\bibitem{Willems}
{\it Willems J. C., Markovsky I., Rapisarda P., De Moor B. L. M.} A note on persistency of excitation //
Systems \& Control Letters. 2005. V.54. P. 325--329.

\bibitem{WillemsPuzzles}
{\it Willems J. C.} Paradigms and puzzles in the theory of dynamical systems //
IEEE Transactions on Automatic Control. 1991. V.36, No 3. P.259--294.
\end{thebibliography}

\AdditionalInformation{Дмитрук Н.М.}{место
работы, должность, Минск}{dmitrukn@bsu.by}

\AdditionalInformation{Манжулина Е.А.}{место
работы, должность, Минск}{fpm.manzhuli@bsu.by}


\end{document}
