%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  Sample document for preparing papers to  "Avtomatika i Telemekhanika"
%%  charset=windows-1251
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[12pt]{a&t}
\usepackage{graphicx}

%added by Lizaveta
\usepackage{todo}
\newcommand{\bigzero}{\mbox{\normalfont\Large\bfseries 0}}
\newcommand{\rvline}{\hspace*{-\arraycolsep}\vline\hspace*{-\arraycolsep}}
\usepackage{bbm}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\usepackage{listings}
\usepackage{verbatim}
\usepackage{float}

\begin{document}  %%%!!!

\year{2020}
\title{ОПТИМАЛЬНОЕ УПРАВЛЕНИЕ ЛИНЕЙНЫМИ СТАЦИОНАРНЫМИ СИСТЕМАМИ БЕЗ ПРЕДВАРИТЕЛЬНОЙ ПАРАМЕТРИЧЕСКОЙ ИДЕНТИФИКАЦИИ СИСТЕМЫ}
%\thanks{Работа выполнена при финансовой поддержке \dots
%(грант \mbox{№\,\dots}).}

\authors{Н.М.~ДМИТРУК, канд.~физ.-мат.~наук (dmitrukn@bsu.by),\\
Е.А.~МАНЖУЛИНА (fpm.manzhuli@bsu.by)\\
(Белорусский государственный университет, Минск)}
%Т.Т.~ТРЕТИЙ\\
%(место работы, если отличается от места работы Ч.Ч. Четвертого),\\
%Ч.Ч.~ЧЕТВЕРТЫЙ\\
%(место работы, например, Институт проблем управления
%им.~В.А.~Трапезникова РАН, Москва)}

\maketitle

\begin{abstract}
Целью работы является решение задачи оптимального управления по неточным выходным сигналам при условии гарантированного удовлетворения геометрических ограничений на выходные сигналы в случае отсутствия параметрической модели системы. Объектом исследования является линейная стационарная дискретная система. В процессе работы был получен метод решения поставленной задачи, опирающийся на наблюдаемые траектории входного и выходного сигналов системы. Новизна предложенного метода состоит в отсутствии шага параметрической идентификации системы, который обычно предшествует решению задачи управления в случае неизвестной системы.
\end{abstract}

\section{Введение}
В современном мире неумолимо возрастает размерность и общая сложность используемых систем. Моделирование многих процессов представляется чрезмерно трудоёмким, а построенная модель зачастую слишком сложна и громоздка для практического использования. В последнее время всё большую популярность набирают методы системного анализа и управления, базирующиеся не на достоверном знании внутренней организации системы, но лишь на ее наблюдаемом поведении. С этим связан возросший интерес к так называемой поведенческой (бихевиористской) теории динамических систем \cite{BehanioralTheory}\todo{}add bibitem. Эта теория привлекла интерес научного сообщества и породила множество замечательных результатов как в системном анализе, так и в оптимальном управлении. Были получены модификации метода MPC (Model Predictive Control), в которых собственно модель в явном виде отсутствует, динамика системы неявно задается ее траекториями \cite{BerberichMPC}. В ряде работ представлены методики стабилизации систем, основанные на данных (в западной литературе --- data-driven methods) \cite{Persis}, \cite{BerberichRobust}. Что до системного анализа, то, к примеру, в \cite{Romer} представлен одношаговый метод проверки системы на диссипативность. Некоторые результаты уже получены и для нелинейных систем\cite{Copp}, хотя в этом направлении продвижение не столь велико.

В данной работе предлагается решение задачи оптимального управления линейной стационарной дискретной системой по неточным выходным сигналам при гарантированном соблюдении наложенных на выходные сигналы ограничений, не опирающееся на модель системы вовсе.

\section{Постановка задачи при наличии модели системы}\label{model-based problem}
Сперва рассмотрим линейную дискретную стационарную систему $G$, минимальная реализация  $(A,B,C,D)$ которой известна:
\begin{equation}
    x(t+1) = Ax(t) + Bu(t), \quad x(0) = x_0, \label{model}
    \end{equation}
$$
    y(t) = Cx(t) + Du(t),
    $$
$$
    t = 0, \ldots, T-1.
    $$
Здесь $ x(t) \in \mathbb{R}^n, u(t) \in \mathbb{R}^m, y(t) \in \mathbb{R}^p$ --- состояние системы, управление и выходной сигнал в момент времени $t$, соответственно.

Траекторией $G$ будем называть такие $\{u(t), y(t)\}_{t=0}^{T-1}$, что удовлетворяют (\ref{model}) при некотором начальном состоянии $x_0$.
Вместо $$\{u(t), y(t)\}_{t=0}^{T-1} = \{(u(0), u(1), \ldots, u(T-1)), (y(0), y(1), \ldots, y(T-1))\},$$ будем зачастую пользоваться более лаконичной записью $\{u_T, y_T\}.$

На управляющие и выходные сигналы наложены следующие ограничения:
\begin{equation} \label{constraints}
    u(t) \in U, \quad y(t) \in Y(t), \quad t = 0, \ldots, T-1,
    \end{equation} 
где множество доступных значений управления и множество допустимых выходных сигналов имеют вид $ U = \{u \in \mathbb{R}^m\ : u_{\min} \leq u \leq u_{\max} \}$, $Y(t) = \{ y \in \mathbb{R}^p : G(t)y \leq g(t) \},$ $G(t) \in \mathbb{R}^{q \times p}, \quad g(t) \in \mathbb{R}^q.$


В последующем будем считать, что в момент времени $\tau$ доступны лишь неточные измерения выходных сигналов $ {\tilde{y}^p(t) = y^p(t) + \xi(t),}$ $ {t = 0, \ldots, \tau - 1}$, где $y^p(t)$ --- точное значение выходного сигнала в соответствии с (\ref{model}), а $\xi(t)$ --- ограниченная ошибка измерения в момент времени ${t = 0, \ldots, \tau -1}$. Верхний индекс $p$ подчеркивает, что измеренные сигналы относятся к конкретной "прошлой"\ (past) траектории.

Начальное состояние $x_0$ и величина погрешности $\xi(t)$ достоверно неизвестны, однако полагаем их в дальнейшем принадлежащими известным множествам: $x_0 \in \mathcal{X}_0, $ $\xi(t) \in \mathit{\Xi},$ где
$\mathcal{X}_0 = \{ x\in \mathbb{R}^n : x_{\min} \leq x \leq x_{\max} \}$, $\mathit{\Xi} = \{ \xi \in \mathbb{R}^p : \norm{\xi}_{\infty} \leq \varepsilon \}$.

Поставим задачу о минимизации следующего квадратичного критерия качества
$$
    J(u) = \sum\limits_{t = 0}^{T-1} \norm{u(t)}^2
    $$
на множестве доступных управляющих воздействий ${u(t) \in U}$, гарантирующих выполнение ограничений на выходные сигналы ${y(t) \in Y(t)}$  при \textit{всех} возможных реализациях  ошибок ${\xi(t) \in \Xi}$ и начального состояния $x_0 \in X.$

Один из возможных методов решения этой задачи, использующий принцип разделения процессов управления и наблюдения(см., к примеру, \cite{SeparationPrinciple}), предложен в \cite{Gabasov}\todo{}add bibitem.  Ознакомиться с ним можно в Приложении к данной работе.

\section{Постановка задачи в отсутствие модели системы}
В последующем сосредоточимся на задаче, поставленной в предыдущем разделе, однако при условии отсутствия заранее известной реализации системы в пространстве состояний. Классический подход в подобных ситуациях состоит в предварительной идентификации системы и последующем решении задачи уже имеющимся способом, основанным на знании модели, как в Приложении. Однако, такой подход не всегда целесообразен.\todo{}когда именно, подробнее?

В этой работе будет предложен альтернативный подход, не нуждающийся в явном параметрическом представлении системы вовсе. Основой ему послужит бихевиористский подход к динамическим системам, необходимые результаты которого будут изложены по мере использования.

Будем считать, что сведения о линейной системе $G$ сводятся к верхней оценке ее размерности $n$ и одной предварительно сгенерированной траектории $\{u^d(t), y^d(t)\}_{t = 0}^{T^d - 1}$, причем эта траектория измерена точно. 

Как и ранее,  траектории "прошлого"\ $${\{(u^p(0), u^p(1), \ldots, u^p(\tau-1)), (y^p(0), y^p(1), \ldots, y^p(\tau-1))\} = \{u_\tau^p, y_\tau^p \}},$$ известные к текущему моменту $\tau$ в процессе управления системой, будем считать измеренными с точностью до ограниченной ошибки: т.е. доступны лишь $\{u_\tau^p, \tilde{y}_\tau^p\}$, где ${\tilde{y}^p_\tau = y^p_\tau + \xi_\tau}$.

В текущий момент времени $\tau$, подобно предыдущему разделу, ставится задача минимизации квадратичного критерия качества
$$
    \sum_{t = \tau}^{T-1} \norm{u(t)}^2,
    $$
при гарантированном соблюдении линейных условий
$$
    G(t)y(t) \leq g(t), \quad u_{\min} \leq u(t) \leq u_{\max}, \quad \tau \leq t \leq T-1,
    $$
на входные и выходные сигналы.

\section{Информативность сгенерированной траектории}
Покажем, как априорная траектория $\{u^d, y^d\}$ при определенных условиях может иметь ту же информационную ценность, что и модель системы $(A,B,C,D)$, в случае ее наличия. Воспользуемся некоторыми результатами бихевиористской теории. 

\begin{definition}\label{persistency exciting}
Пусть $t,T \in \mathbb{Z}_{ \geq 0}, \quad T \geq t$. Входной сигнал
$u = (u(0), \cdots, u(T-1)) \in \mathbb{R}^{mT}$ является \textit{постоянно возбуждающим порядка $t$}, если соответствующая матрица Ганкеля \[H_t(u) =
\begin{pmatrix}
  u(0) & u(1) & \cdots & u(T-t)\\
  u(1) & u(2) & \cdots & u(T-t+1)\\
  \vdots & \vdots & \ddots & \vdots \\
  u(t-1) & u(t) & \cdots & u(T-1)
\end{pmatrix}
\]
имеет полный строчный ранг.
\end{definition}

\begin{remark}\label{remark on input length}
Если входной сигнал $u = (u(0), \cdots, u(T-1)) \in \mathbb{R}^{mT}$ является постоянно возбуждающим порядка $t$, то он является и достаточно длинным. Поскольку матрица имеет полный строчный ранг, число строк не   превышает число столбцов: $T -t + 1 \geq mt$. Отсюда следует необходимое условие на длину $T$ постоянно возбуждающего сигнала порядка $t$: $T \geq t(m+1) - 1,$ где $m$~--- размерность сигнала.
\end{remark}

Постоянно возбуждающие входные сигналы достаточно высокого порядка возбуждают систему таким образом, что выходные сигналы репрезентативны для поведения системы. Центральный результат работы \cite{Willems} указывает, какого порядка достаточно. Этот результат получил непосредственный перевод на язык классических моделей в пространстве состояний в работе \cite{Berberich}.
\begin{theorem}\label{trajectory check}
Пусть $\{u^d(t), y^d(t)\}_{t=0}^{T^d-1}$ --- траектория линейной системы $G$ размерности $n$, причем $u^d$ --- постоянно возбуждающий входной сигнал порядка $T+n$. Тогда $\{u(t), y(t)\}_{t=0}^{T-1}$ является траекторией $G$ в том и только в том случае, когда для
\begin{equation}
\begin{pmatrix}
H_T(u^d) \\
H_T(y^d)
\end{pmatrix} \alpha = \begin{pmatrix}
u \\
y
\end{pmatrix}
\end{equation}
существует решение $\alpha \in \mathbb{R}^{T^d-T+1}.$
\end{theorem}

Теорема \ref{trajectory check} в непосредственно приведенной формулировке позволяет проверять любую траекторию фиксированной длины на принадлежность множеству траекторий системы. В рассматриваемом случае стоит обратная задача: чтобы определить, допустимо ли конкретное управление в конкретный момент времени, хотелось бы уметь в некотором смысле симулировать систему.

Модификацию теоремы \ref{trajectory check} можно использовать для генерации множества возможных траекторий $\{u^p_\tau, u, y^p_\tau, y\}$ длины $T$ с некоторой фиксированной "прошлой"\ начальной частью $\{u^p_\tau, y^p_\tau\}$ длины $\tau$. Нефиксированную часть ${\{u, y\} = \{u(\tau), \ldots, u(T-1), y(\tau), \ldots, y(T-1)\}}$ будем называть "будущей"\ частью траектории.
Соответственно, будем делить на "прошлое"\ и "будущее"\ для момента $\tau$ и строки матриц Ганкеля для априорной траектории:
\begin{equation}
H_T(u^d) = \begin{pmatrix}
  u^d(0) & \cdots & u^d(T^d-T)\\
  \vdots & \ddots & \vdots \\
  u^d(\tau-1) & \cdots & u^d(\tau-1 + T^d - T) \\
  \hline
  u^d(\tau) & \cdots & u^d(\tau + T^d-T)\\
  \vdots & \ddots & \vdots \\
  u^d(T-1) & \cdots & u^d(T^d-1)
\end{pmatrix} =
		\begin{pmatrix}
		U_{\tau}^p \\
		U_{\tau}^f
		\end{pmatrix},
\end{equation}
\begin{equation}
H_T(y^d) = \begin{pmatrix}
  y^d(0) & \cdots & y^d(T^d-T)\\
  \vdots & \ddots & \vdots \\
  y^d(\tau-1) & \cdots & y^d(\tau-1 + T^d - T) \\
  \hline
  y^d(\tau) & \cdots & y^d(\tau + T^d-T)\\
  \vdots & \ddots & \vdots \\
  y^d(T-1) & \cdots & y^d(T^d-1)
\end{pmatrix} =
		\begin{pmatrix}
		Y_{\tau}^p \\
		Y_{\tau}^f
		\end{pmatrix},
\end{equation}

Если входной сигнал $u^d$ является постоянно возбуждающим порядка ${n + T}$, то, согласно теореме \ref{trajectory check}, $\{u_{\tau}^p, u, y_{\tau}^p, y\}$ является траекторией системы $G$ тогда и только тогда, когда уравнение
\begin{equation}\label{traj-cond}
\begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f \\
Y_{\tau}^f
\end{pmatrix} \alpha = \begin{pmatrix}
u_{\tau}^p \\
y_{\tau}^p \\
u \\
y
\end{pmatrix}
\end{equation}
имеет решение $\alpha \in \mathbb{R}^{T^d - T +1}$.
Поэтому для построения возможных траекторий можно воспользоваться следующим алгоритмом:\\
1. Зафиксировать интересующее значение "будущего"\ входного сигнала $u$.\\
2. Для выбранного $u$ найти некоторое решение $\alpha \in \mathbb{R}^{T^d-T+1}$ системы линейных алгебраических уравнений
\begin{equation}
\begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f
\end{pmatrix} \alpha = \begin{pmatrix}
u_{\tau}^p \\
y_{\tau}^p \\
u
\end{pmatrix}.
\end{equation}
3. Вычислить $y = Y_{\tau}^f \alpha$. Получили одну из возможных траекторий для фиксированных $u^p_\tau, y^p_\tau, u$.

\begin{remark}
В силу теоремы \ref{trajectory check}, для любых $u^p_\tau, y^p_\tau, u$ хотя бы одну возможную выходную траекторию $y$ мы найти сможем, а вот для единственности $y$, которая представляет особый практический интерес, нужно наложить некоторые условия. Поскольку для линейной системы размерности $n$ траектория длины $n$ однозначно определяет начальное состояние, то для обеспечения единственности достаточно потребовать $\tau \geq n$. Потому в дальнейшем полагаем, что управление начинается в момент $n$, --- это своего рода неявный аналог явного ограничения $x_0 \in X_0$ в постановке задачи при известной модели.
\end{remark}

\begin{remark}\label{lower bound on T^d}
Чем больше горизонт планирования $T$, тем больше и длина априорной траектории $T^d$. Поскольку нам необходим постоянно возбуждающий порядка $n + T$ сигнал $u^d$, то,  как уже отмечалось в Замечании \ref{remark on input length}, для длины $T^d$ этого сигнала справедлива оценка $T^d \geq (n + T)(m + 1) - 1,$ где $m$ --- размерность входа.
\end{remark}

Вместо явного задания динамики системы моделью $(A,B,C,D)$ в пространстве состояний, будем пользоваться неявным описанием  поведения системы в виде (\ref{traj-cond}). Начальное состояние системы также фиксируем неявно, начиная управление в момент $n$.

Таким образом, в каждый момент времени $n \leq \tau \leq T$ решаем следующую задачу оптимального программного управления, обладая неточной траекторией $\{u_\tau^p, \tilde{y}_\tau^p\}$:
\begin{equation}\label{dd-oc-at-tau}
\min\limits_{u} u^Tu,
\end{equation}
$$
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
\end{pmatrix} \alpha = \begin{pmatrix}
u_\tau^p \\
y_\tau^p \\
u \\
\end{pmatrix},
$$
$$
\tilde{y}_\tau^p = y_\tau^p + \xi_\tau, \quad -\varepsilon\mathbbm{1} \leq \xi_\tau \leq \varepsilon \mathbbm{1},
$$
$$u_{\min}(\tau) \leq u \leq u_{\max}(\tau),$$
$$
G_\tau Y_\tau^f \alpha \leq g_\tau \quad \forall \alpha, \xi_\tau,
$$
где матрица
\[
G_\tau =
\begin{pmatrix}
  \begin{matrix}
  G(\tau)
  \end{matrix}
  & \rvline & \bigzero & \rvline & \cdots & \rvline & \bigzero\\
\hline
  \bigzero & \rvline &
  \begin{matrix}
    G(\tau + 1)
  \end{matrix}
  & \rvline & \cdots  & \rvline & \bigzero \\
\hline
  \vdots & \rvline & \vdots & \rvline &
  \begin{matrix}
    \ddots
  \end{matrix}
  & \rvline & \bigzero \\
\hline
  \bigzero & \rvline & \bigzero & \rvline & \bigzero & \rvline &
  \begin{matrix}
    G(T-1)
  \end{matrix}
\end{pmatrix},
\]
вектор $g_{\tau} = (g(\tau), g(\tau+1), \cdots, g(T-1)),$ \\
$u_{\min}(\tau) = (\underbrace{u_{\min}, \ldots, u_{\min}}_{T - \tau \textup{ раз}}), \quad u_{\max}(\tau) = (\underbrace{u_{\max}, \ldots, u_{\max}}_{T - \tau \textup{ раз}}).$

Здесь и далее $\mathbbm{1}$ обозначает единичный вектор, размерность которого понятна из контекста.

Из полученного в момент $\tau$ оптимального управляющего воздействия $u^*(\tau, u^p_\tau, \tilde{y}^p_\tau) = (u^*(\tau|\tau, u^p_\tau, \tilde{y}^p_\tau), u^*(\tau+1|\tau, u^p_\tau, \tilde{y}^p_\tau), \ldots, u^*(T-1|\tau, u^p_\tau, \tilde{y}^p_\tau))$  применяем к системе $u^p(\tau) := u^*(\tau|\tau, u^p_\tau, \tilde{y}^p_\tau)$. Переходим к решению задачи (\ref{dd-oc-at-tau}) в момент $\tau+1$, зная траекторию $\{u^p_{\tau+1}, \tilde{y}^p_{\tau+1}\}$. Таким образом, если существовало допустимое воздействие в момент $\tau$, то гарантированно существует допустимое воздействие в момент $\tau + 1$, причем значение критерия качества на каждом шагу не увеличивается.\todo{}тут стоит подробнее, очень формально, с Беллманом разъяснить, или излишне?

\section{Принцип разделимости}
Для решения задачи (\ref{dd-oc-at-tau}) многообещающим выглядит разделение задач наблюдения и управления. Продемонстрируем, как элегантно реализуется принцип разделимости в бихевиористском подходе.

\begin{lemma}\label{dd-separation}
Пусть $\{u_{\tau}^p, y_{\tau}^p \}$ --- некоторая фиксированная траектория системы (\ref{traj-cond}) длины $\tau \geq n$. Тогда любая траектория $\{u_{\tau}^p, u, y_{\tau}^p, y\}$ длины $T$ системы (\ref{traj-cond}) однозначно представима в виде суммы траекторий $\{0, u, 0, y_0\}$ и $\{u_{\tau}^p, 0, y_{\tau}^p, \hat{y}\}$ длины $T$, причем для фиксированного $u$ определить неизвестные участки $y_0, \hat{y}$ можно следующим образом:\\
1. Найти некоторые решения $\hat{\alpha}, \alpha_0$ алгебраичеких уравнений
\begin{equation}
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
\end{pmatrix} \hat{\alpha} = \begin{pmatrix}
u_\tau^p \\
y_\tau^p \\
0 \\
\end{pmatrix}, \quad
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
\end{pmatrix} \alpha_0 = \begin{pmatrix}
0 \\
0 \\
u \\
\end{pmatrix}.
\end{equation}
2. Вычислить $\hat{y} = Y_\tau^f\hat{\alpha}, \quad y_0 = Y_\tau^f\alpha_0$.
\end{lemma}

\begin{proof}
Поскольку длина $\tau$ исходной траектории не меньше размерности системы $n$, то, в силу модификации теоремы \ref{trajectory check}, однозначно определены и могут быть найдены в результате 1-2 выходные сигналы системы $\hat{y}, y_0$ для входных сигналов $0, u$ соответственно. Более того, $\hat{y}$ соответствует выходной траектории неуправляемой с момента $\tau$ системы, а $y_0$ ---  выходному сигналу номинальной системы из нулевого состояния в момент $\tau$. Здесь нулевое состояние в момент $\tau$  неявно задают $\{u_\tau^p, y_\tau^p\} = \{0, 0\}$ --- именно такую траекторию имеет система с нулевым начальным состоянием, а значит, и с нулевым состоянием в момент $ \tau$; с другой стороны, $\tau \geq n$ обеспечивает единственность этой траектории. $\Box$
\end{proof}

В связи с вышеизложенным, ограничение на выходные сигналы принимает вид
$G_{\tau}(y_0+\hat{y}) \leq g_{\tau}$. Наложим на $y_0$ суженное условие:
\begin{equation}\label{tightened constraint}
G_{\tau}y_0 \leq g_{\tau}-\chi(\tau),
\end{equation}
где каждая компонента $\chi_i(\tau)$ соответствует наихудшей реализации состояния системы в момент $\tau$, а именно является решением задачи линейного программирования
\begin{equation} \label{estimation}
\chi_i(\tau) = \max\limits_{\hat{\alpha}, \xi_{\tau}, \hat{y}} G_{\tau i}\hat{y},
\end{equation}
$$\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
Y_\tau^f \\
\end{pmatrix} \hat{\alpha} = \begin{pmatrix}
u_\tau^p \\
\tilde{y}_\tau^p + \xi_{\tau}\\
0 \\
\hat{y}\\
\end{pmatrix},
$$
$$-\varepsilon \mathbbm{1} \leq \xi_{\tau} \leq \varepsilon \mathbbm{1}.$$
Задача (\ref{estimation}) в компактной формулировке (исключается $\xi_{\tau}$) имеет вид
\begin{equation} \label{estimation-lp}
\chi_i(\tau) = \max\limits_{\hat{\alpha}} G_{\tau i}Y_{\tau}^f\hat{\alpha},
\end{equation}
$$\begin{pmatrix}
U_\tau^p \\
U_\tau^f \\
\end{pmatrix} \hat{\alpha} = \begin{pmatrix}
u_\tau^p \\
0 \\
\end{pmatrix},
$$
$$
\tilde{y}_{\tau}^p-\varepsilon \mathbbm{1} \leq
Y_\tau^p \hat{\alpha} \leq
\tilde{y}_\tau^p + \varepsilon \mathbbm{1}.
$$
Выполнение  для $y_0$ суженного ограничения (\ref{tightened constraint}) очевидно влечет удовлетворение исходного ограничения на $y$ для любой возможной реализации $\hat{y}$.

Детерминированная задача оптимального программного управления с суженными условиями на $y_0$ принимает следующий вид:

\begin{equation}\label{control}
\min\limits_{\alpha_0, u, y_0}u^Tu,
\end{equation}
$$\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
Y_\tau^f \\
\end{pmatrix} \alpha_0 = \begin{pmatrix}
0 \\
0 \\
u \\
y_0 \\
\end{pmatrix},$$
$$G_{\tau}y_0 \leq g_{\tau} - \chi(\tau),$$
$$u_{\min}(\tau) \leq u \leq u_{\max}(\tau).$$

Снова переходим к эквивалентному, но более компактному виду, получаем
\begin{equation}\label{control-qp}
\min\limits_{\alpha_0}\alpha_0^T{U_{\tau}^f}^TU_{\tau}^f\alpha_0,
\end{equation}
$$
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
\end{pmatrix} \alpha_0 = \begin{pmatrix}
0 \\
0 \\
\end{pmatrix},
$$
$$G_{\tau}Y_{\tau}^f\alpha_0 \leq g_{\tau} - \chi(\tau),$$
$$u_{\min}(\tau) \leq U_{\tau}^f\alpha_0 \leq u_{\max}(\tau).$$
Получив решение $\alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)$ задачи  (\ref{control-qp}), вычисляем оптимальное управление ${u^*(\tau, u_\tau^p, \tilde{y}_\tau^p) = U_\tau^f \alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)}$. Из вычисленного ${u^*(\tau, u_\tau^p, \tilde{y}_\tau^p) = (u^*(\tau|\tau, u_\tau^p, \tilde{y}_\tau^p), \ldots, u^*(T-1|\tau, u_\tau^p, \tilde{y}_\tau^p))}$ подаем на вход системе ${u^p(\tau) = u^*(\tau|\tau, u_\tau^p, \tilde{y}_\tau^p).}$

\bigskip
Таким образом, задача оптимального управления, решаемая в каждой временной точке $n \leq \tau \leq T-1$, свелась к нескольким задачам линейного программирования и одной выпуклой задаче квадратичного программирования.

\section{Недетерминированный случай: априорные измерения неточны}
В этом разделе будет кратко приведена идея развития результатов.
Интерес представляет случай, когда и априорные измерения содержат некоторую ошибку, т.е. $\tilde{y}^d = y^d + \xi^d.$

\todo{}может, выкинуть этот раздел, и вкратце в заключении упомянуть идею

Тогда $\tilde{Y}_{\tau}^p = Y_{\tau}^p + \mathit{\Xi}_{\tau}^p$,
$\tilde{Y}_{\tau}^f = Y_{\tau}^f + \mathit{\Xi}_{\tau}^f$, где
$$
\begin{pmatrix}
		\mathit{\Xi}_{\tau}^p\\
		\mathit{\Xi}_{\tau}^f
		\end{pmatrix}  = \begin{pmatrix}
  \xi(0) & \cdots & \xi(T^d-T)\\
  \vdots & \ddots & \vdots \\
  \xi(\tau-1) & \cdots & \xi(\tau - 1 + T^d-T) \\
  \hline
  \xi(\tau) & \cdots & \xi(\tau + T^d-T)\\
  \vdots & \ddots & \vdots \\
  \xi(T-1) & \cdots & \xi(T^d-1)
\end{pmatrix}
    = H_T(\xi^d).
$$

В соответствии с этим задача оптимального оценивания (\ref{estimation}) перепишется следующим образом:

\begin{equation} \label{estimation-noisy}
\chi_i(\tau) = \max\limits_{\hat{\alpha}, \xi_{\tau}, \xi^d} G_{\tau i}\hat{y},
\end{equation}
$$\begin{pmatrix}
U_\tau^p \\
Y_\tau^p + \mathit{\Xi}_\tau^p\\
U_\tau^f \\
Y_\tau^f + \mathit{\Xi}_\tau^f \\
\end{pmatrix} \hat{\alpha} = \begin{pmatrix}
u_\tau^p \\
\tilde{y}_\tau^p + \xi_{\tau}\\
0 \\
\hat{y}\\
\end{pmatrix},
$$
$$-\varepsilon \mathbbm{1} \leq \xi_{\tau} \leq \varepsilon \mathbbm{1},$$
$$-\varepsilon \mathbbm{1} \leq \xi^d \leq \varepsilon \mathbbm{1}.$$

Задача (\ref{estimation-noisy}) представяет собой задачу с квадратичной целевой функцией и квадратичными ограничениями относительно переменной $(\hat{\alpha}, \xi^d)$. Сложность заключается в том, данная задача является невыпуклой. В дальнейшем было бы интересно исследовать эффективные способы решения этой невыпуклой задачи оптимального оценивания. Впоследствии можно использовать этот результат для решения соответствующей задачи оптимального управления в условии неточной априорной траектории.

\section{Численный пример}
Применим изложенный метод для управления следующей системой размерности $n = 3$ с одним входом и одним выходом: 
$$x(t+1) = \begin{pmatrix}
0.8639 & 0.3075 & -0.2086 \\
-0.146 & 0.9265 & 0.245 \\
-0.1715 & -0.2195 & 1\\
\end{pmatrix} 
x(t) + \begin{pmatrix}
0.1239 \\
-0.0847 \\
0.1602\\
\end{pmatrix}u(t),$$
$$y(t) = \begin{pmatrix}
0.3 & 1.5 & -0.7 \\
\end{pmatrix}x(t) + \begin{pmatrix}
-1.4
\end{pmatrix}u(t), \quad t= 0, \ldots, T-1,$$
минимизируя критерий качества $\sum_{t=0}^{T-1}\norm{u(t)}^2$ при гарантированном соблюдении ограничений $-1 \leq u(t) \leq 1, \quad -1 \leq y(t) \leq 1, \quad t = n, \ldots, T-1.$
Момент начала управления такой же, как и размерность системы $n = 3$ --- этого достаточно для неявного задания начального условия $x_0.$ Горизонт планирования $T = 120.$ 

Как было отмечено в Замечании \ref{lower bound on T^d}, длина априорной траектории $T^d$ должна быть не меньше $(n + T)(m + 1) - 1$, что в нашем случае, при $n = 3, m = 1$, означает $T^d \geq 2(3+T) - 1 = 245.$ Именно такой, наименьшей подходящей длины, была предварительно сгенерирована зашумленная траектория $\{u^d, \tilde{y}^d\}.$ Входные сигналы были сгенерированы как случайные числа, равномерно распределенные в $[-1, 1]$, а ошибки, добавляемые к "чистой"\ выходной траектории $y^d$, --- как случайные числа, равномерно распределенные в $[-\varepsilon, \varepsilon], \quad \varepsilon = 0.002.$

После таким же образом была сгенерирована траектория $\{u^p_3, \tilde{y}^p_3\}$, соответствующая движению системы до начала управления:
$$u_3^p = \begin{pmatrix}
   0.11004849  \\
   0.59704522  \\
   0.43059520 
\end{pmatrix},
y_3^p = \begin{pmatrix}
  0.70244403  \\
  -0.07057178 \\
   0.07171414 
\end{pmatrix}.
$$
Ниже приведены управление, выход и фазовая траектория, полученные в результате применения предложенного метода.

\begin{figure}[H]
\centering
\includegraphics[scale = 0.9]{ufinal.eps}
\caption{\ }
\end{figure}
Значение критерия качества составляет $2.84904042$ на первой итерации, $2.60124510$ --- на последней.

\begin{figure}[H]
\centering
\includegraphics[scale = 0.9]{yfinal.eps}
\caption{\ }
\end{figure}

На рис. \ref{phase} точкой $\circ$ отмечено начальное положение, а звездочкой *~--- конечное положение траектории.
\begin{figure}[H]
\centering
\includegraphics[scale= 0.9]{xfinal.eps}
\caption{\ }
\label{phase}
\end{figure}


\section{Заключение}
В данной работе был предложен новый способ решения задачи оптимального управления линейной стационарной системой по неточным выходным сигналам при гарантированном соблюдении наложенных на выходные сигналы ограничений. Этот способ не требует знания реализации системы в пространстве состояний. Предложенный метод сводится к решению задач линейного и квадратичного программирования, базирующихся лишь на двух траекториях системы: априорной и наблюдаемой в процессе управления.

Задача решена в предположении, что траектория, измеряемая в процессе управления, неточна, но априорная траектория известна точно. Было предложено дальнейшее направление исследования: случай, когда априорная траектория также зашумлена. 

\appendix{}
Метод решения задачи, поставленной в разделе \ref{model-based problem}.
\begin{definition}
Назовем состояние $x(\tau)$ \textit{согласующимся} c траекторией $\{u_\tau^p, \tilde{y}_\tau^p\}$, если найдутся такие допустимые начальное состояние $x_0 \in X_0$ и ошибки измерения $\xi(t) \in \Xi, \quad t = 0, \ldots, \tau - 1$, что
$$
    x(\tau) = x(\tau |x_0, u_\tau^p),
    $$
$$
    \tilde{y}^p(t) = Cx(t | x_0, u_t^p) + Du^p(t) + \xi(t), 
    $$
$$
    t = 0, \ldots, \tau -1,
    $$
\end{definition}
где $x(t|x_0, u_t^p)$ --- состояние, в которое система (\ref{model}) приходит в момент $t$, двигаясь из начальной точки $x(0) = x_0$ под воздействием управления $u_t^p$.

Обозначим через $X(\tau, u_\tau^p, \tilde{y}_\tau^p)$ множество всех состояний $x(\tau)$, согласующихся с~$\{u_\tau^p, \tilde{y}_\tau^p\}$.

Изложим стратегию оптимального управления в поставленной задаче, предложенную в \cite{Gabasov}\todo{}add bibitem.

В каждый момент времени $\tau = 0, \ldots, T-1$, обладая знанием неточной траектории $\{u_\tau^p, \tilde{y}_\tau^p\}$,  решаем следующую задачу оптимального программного управления:
\begin{equation}\label{oc-at-tau}
    \min\limits_u \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,
    \end{equation}
$$ 
    x(t+1) = Ax(t) + Bu(t),
    $$
$$ 
    y(t) = Cx(t) + Du(t),
    $$
$$
    u(t) \in U, \quad 
    y(t) \in Y(t) \quad \forall x(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
$$
    t = \tau, \ldots, T-1.
    $$

Пусть $u^*(t|\tau, u_\tau^p, \tilde{y}_\tau^p), t = \tau, \ldots, T-1$, --- оптимальное управление в задаче (\ref{oc-at-tau}). Тогда в момент $\tau$ подаем на вход лишь первое значение 
$$
    u^p(\tau) = u^*(\tau|\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
после чего переходим к следующей задаче оптимального программного управления (\ref{oc-at-tau}), сформулированной уже в момент $\tau + 1$, на единицу уменьшившимся горизонтом планирования и обогатившимся знанием о поведении системы в лице более длинной траектории $\{u_{\tau+1}^p, \tilde{y}_{\tau+1}^p\}.$


Далее, воспользовавшись принципом разделимости процессов управления и наблюдения для линейных систем, разделяем решение задачи (\ref{oc-at-tau}) на решение ряда задач оптимального наблюдения и одной задачи детерминированного оптимального управления.

Так, представив состояние $x(t)$ и выходной сигнал $y(t)$ в виде $x(t) = x_0(t) + \hat{x}(t),$ $y(t) = y_0(t) + \hat{y}(t)$, где $x_0(t), y_0(t)$ соответствуют состоянию и выходу номинальной системы с тривиальным начальным состоянием
$$
    x_0(t+1) = Ax_0(t) + Bu(t), \quad x_0(\tau) = 0,
    $$
$$
    y_0(t) = Cx_0(t) + Du(t), \quad t = \tau, \ldots, T-1,
    $$
а $\hat{x}(t), \hat{y}(t)$ соответствуют состоянию и выходу неуправляемой системы с неопределенным начальным состоянием
$$
    \hat{x}(t) = A\hat{x}(t), \quad \hat{x}(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
$$
    \hat{y}(t) = C\hat{x}(t), \quad t = \tau, \ldots, T-1,
    $$
можем рассмотреть ограничение на выходные сигналы (\ref{constraints}) в виде
$$
    G(t)(y_0(t) + \hat{y}(t)) \leq g(t), \quad \forall x(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
что влечет естественное суженное условие на $y_0(t)$, удовлетворение которого будет гарантировать допустимость выходного сигнала $y(t)$:
\begin{equation}\label{model-chi}
    y_0(t) \in Y_0(t | \tau) = \{y \in \mathbb{R}^p : G(t)y \leq g(t) - \chi(t|\tau)\},
    \end{equation}
где каждая компонента вектора $\chi(t | \tau)$ соответствет наихудшей реализации состояния $x(\tau)$:
\begin{equation}
    \chi_i(t | \tau) = \max\limits_z G_i(t)\hat{y}(t),
    \end{equation}
$$
    \hat{x}(s+1) = A\hat{x}(s), \quad \hat{x}(\tau) = z,
    $$
$$
    y(s) = C\hat{x}(s), \quad s = \tau, \ldots, t,
    $$
$$
    z \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
где $G_i(t)$ обозначает $i$--ю строку матрицы $G(t).$

После вычисления всех оценок $\chi(t|\tau), \quad t = \tau, \ldots, T-1$, оптимальное управление $u^*(t|\tau, u_\tau^p, \tilde{y}_\tau^p)$ получаем как решение следующей детерминированной задачи оптимального управления:
\begin{equation}\label{model-det-oc}
\min\limits_u \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,
\end{equation}
$$
    x_0(t+1) = Ax_0(t) + Bu(t), \quad x_0(\tau) = 0,
    $$
$$
    y_0(t) = Cx_0(t) + Du(t),
    $$
$$  
    u(t) \in U, \quad y_0(t) \in Y_0(t | \tau),
    $$
$$
    t = \tau, \ldots, T-1.
    $$

\begin{thebibliography}{10}
\bibitem{Dmitruk2004}
{\it Габасов Р., Дмитрук Н.М., Кириллова Ф.М.} Оптимальное управление многомерными системами по неточным измерениям их выходных сигналов // Труды Института математики и механики УрО РАН. 2004  Т. 10. № 2. С. 33--57.

\bibitem{Berberich}
{\it Berberich J., Allg{\"o}wer F.} A trajectory-based framework for data-driven system analysis and control //
arXiv: 1903.10723. 2019.

\bibitem{BerberichRobust} 
{\it Berberich J., Romer A., Scherer C. W., Allg{\"o}wer F.} Robust data-driven state-feedback design //
arXiv: 1909.04314. 2019.

\bibitem{BerberichMPC}
{\it Berberich J., K{\"o}hler J., M{\"u}ller M. A., Allg{\"o}wer F.} Data-Driven Model Predictive Control with Stability and Robustness Guarantees //
arXiv: 1906.04679. 2019.

\bibitem{Copp}
{\it Copp D., Hespanha J.} Simultaneous nonlinear model predictive control and state estimation //
Automatica. 2016. V. 77. P. 143--154.

\bibitem{Coulson}
{\it Coulson J., Lygeros J., D{\"o}rfler F.} Data-Enabled Predictive Control: In the Shallows of the DeePC // 
18th European Control Conference (ECC), Naples, Italy. 2019. P. 307--312.

\bibitem{SeparationPrinciple}
{\it Kurzhanskii A. B., V\'{a}lyi I.}
Ellipsoidal calculus for estimation and control. Nelson Thornes, 1997

\bibitem{Persis}
{\it De Persis C., Tesi P.} Formulas for data--driven control: Stabilization, optimality and robustness //
arXiv: 1903.06842. 2019.

\bibitem{Romer}
{\it Romer A., Berberich J., K{\"o}hler J., Allg{\"o}wer F.} One--shot verification of dissipativity properties from input--output data //
IEEE Control Systems Letters. 2019. V. 3, No.3. P. 709--714.

\bibitem{Waarde}
{\it Waarde H. J., Eising J., Trentelman H. L., Camlibel M. K.} Data informativity: a new perspective on data-driven analysis and control //
arXiv: 1908.00468. 2019.

\bibitem{Willems}
{\it Willems J. C., Markovsky I., Rapisarda P., De Moor B. L. M.} A note on persistency of excitation // 
Systems \& Control Letters. 2005. V.54. P. 325--329.

\bibitem{WillemsPuzzles}
{\it Willems J. C.} Paradigms and puzzles in the theory of dynamical systems //
IEEE Transactions on Automatic Control. 1991. V.36, No 3. P.259--294.
\end{thebibliography}

\AdditionalInformation{Дмитрук Н.М.}{место
работы, должность, Минск}{dmitrukn@bsu.by}

\AdditionalInformation{Манжулина Е.А.}{место
работы, должность, Минск}{fpm.manzhuli@bsu.by}


\end{document}
