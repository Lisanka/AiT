%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  Sample document for preparing papers to  "Avtomatika i Telemekhanika"
%%  charset=windows-1251
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[12pt]{a&t}
\usepackage{graphicx}

%added by Lizaveta
\newcommand{\bigzero}{\mbox{\normalfont\Large\bfseries 0}}
\newcommand{\rvline}{\hspace*{-\arraycolsep}\vline\hspace*{-\arraycolsep}}
\usepackage{bbm}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\usepackage{float}
\usepackage{hyphsubst}
\usepackage{subcaption}

%added by Nat
\usepackage{xcolor}




\begin{document} 

\year{2020}
\title{ОПТИМАЛЬНОЕ УПРАВЛЕНИЕ ЛИНЕЙНЫМИ СТАЦИОНАРНЫМИ СИСТЕМАМИ БЕЗ ПРЕДВАРИТЕЛЬНОЙ ПАРАМЕТРИЧЕСКОЙ ИДЕНТИФИКАЦИИ СИСТЕМЫ}

\authors{Н.М.~ДМИТРУК, канд.~физ.-мат.~наук (dmitrukn@bsu.by),\\
Е.А.~МАНЖУЛИНА (fpm.manzhuli@bsu.by)\\
(Белорусский государственный университет, Минск)}

\maketitle

\begin{abstract}
Рассматривается задача оптимального управления линейной стационарной дискретной системой по неточным измерениям ее выходных сигналов при условии гарантированного удовлетворения геометрических ограничений на выходные сигналы. Исследуется случай, когда минимальная реализация системы в пространстве состояний известна, и случай, когда параметрическая модель системы не известна. Предлагается новый метод решения поставленной задачи в случае неизвестной модели, опирающийся на единственную наблюдаемую траекторию входного и выходного сигнала системы и позволяющий опустить этап ее параметрической идентификации.
\end{abstract}


\section{Введение}
В современном мире неумолимо возрастает размерность и общая сложность систем управления. Моделирование многих процессов представляется чрезмерно трудоемким, а построенная модель зачастую слишком сложна и громоздка для практического использования. В последние годы все большую популярность набирают методы системного анализа и управления, базирующиеся не на достоверном знании внутренней организации системы (ее модели), но лишь на ее наблюдаемом поведении (измеренных выходных сигналах). В  литературе (см., например, \cite{Review}) новые методы получили название data-driven control methods, т.е. методы управления на основе данных. Настоящая работа примыкает к направлению в рамках теории управления на основе данных, истоки которого находятся в поведенческой (бихевиористской) теории динамических систем. В рамках этой теории будем опираться в основном на результаты работы \cite{Willems}, согласно которой пространство всех траекторий  линейной стационарной дискретной системы порождается сдвигами по времени априорных измерений выходных сигналов системы (и, таким образом, образующих матрицу Ганкеля), записанных в одном единственном процессе наблюдения при условии постоянно возбуждающего входного сигнала (управления), и на развитие этих результатов в \cite{BerberichAllgower} для описания систем в пространстве состояний. В качестве примеров успешного использования результатов \cite{BerberichAllgower} отметим работы по  стабилизации линейных стационарных систем \cite{BerberichMPC, BerberichRobust, Persis}, а также одношаговый метод проверки системы на диссипативность \cite{Romer}. Некоторые результаты получены и для нелинейных систем \cite{Persis, Coulson}, хотя в этом направлении продвижение не столь велико.

Цель настоящей работы --- исследование задачи оптимального гарантированного управления линейной стационарной дискретной системой по неточным измерениям выходных сигналов и при наличии ограничений, в формулировке которой собственно модель в явном виде отсутствует, а динамика системы неявно задается данными априорного наблюдения. При наличии параметрической модели аналогичная задача для непрерывных систем и с терминальными ограничениями на состояния исследовалась в работе \cite{Dmitruk2004}, где в режиме реального времени строятся реализации оптимальной обратной связи по измерениям на основе решения ряда задач оптимального наблюдения и управления. Принцип разделимости процесса на наблюдение и управление, а также формулировки соответствующих задач в рамках подхода на основе данных составляют центральные результаты настоящей работы.



\section{Оптимальное гарантированное управление линейной системой}\label{model-based problem}
Рассмотрим линейную  стационарную дискретную систему $G$, минимальная реализация  $(A,B,C,D)$ которой известна:
\begin{align}\label{model}
    & x(t+1) = Ax(t) + Bu(t),  \ \ x(0) = x_0, \\
    & y(t) = Cx(t) + Du(t), \ \ t = 0, \ldots, T-1.\nonumber
    \end{align}
Здесь $x(t) \in \mathbb{R}^n$, $u(t) \in \mathbb{R}^m$, $y(t) \in \mathbb{R}^p$ --- состояние системы, управление и выходной сигнал в момент времени $t$, $(A,B)$ --- управляема, $(A,C)$ --- наблюдаема.

Траекторией системы $G$ будем называть пару $\{u, y\} = \{u(t), y(t)\}_{t=0}^{T-1}$ из управления и выходного сигнала,  удовлетворяющую (\ref{model}) при некотором (наблюдателю неизвестном) начальном состоянии $x(0) \in \mathbb{R}^n$.


Относительно начального состояния $x(0) = x_0$ будем предполагать, что информация о нем ограничивается включением $x_0 \in X_0 = \{ x\in \mathbb{R}^n : x_{\min} \leq x \leq x_{\max} \}$.


На траекторию $\{u,y\}$ наложим ограничения:
\begin{equation} \label{constraints}
    u(t) \in U, \quad y(t) \in Y(t), \quad t = 0, \ldots, T-1,
    \end{equation}
где $U = \{u \in \mathbb{R}^m : u_{\min} \leq u \leq u_{\max} \}$ --- множество доступных значений управления,  $Y(t) = \{ y \in \mathbb{R}^p: G(t)y \leq g(t) \}$ --- множество допустимых значений выходного сигнала в момент времени $t$,  $G(t) \in \mathbb{R}^{q \times p}$, $g(t) \in \mathbb{R}^q$, $t = 0, \ldots, T-1$.

Поставим задачу о минимизации энергетических затрат на управление системой
\begin{equation*}\label{cost}
    J(u) = \sum\limits_{t = 0}^{T-1} \norm{u(t)}^2
    \end{equation*}
на множестве доступных управляющих воздействий $u(t) \in U$, гарантирующих выполнение ограничений на выходные сигналы (\ref{constraints}) при всех возможных реализациях начального состояния $x(0) \in X_0$:
\begin{align}\label{oc-at-0}
    \min_{u}  \ \ &  \sum_{t=0}^{T-1} ||u(t)||^2, \\
      &   x(t+1) = Ax(t)+Bu(t), \nonumber\\
               &   y(t) = Cx(t)+Du(t), \nonumber\\
               &   u(t)\in U, \ \ y(t) \in  Y(t)\ \
                   \forall x(0)\in X_0, \nonumber\\
               & t=0,1,\ldots, T-1. \nonumber
\end{align}
Задача (\ref{oc-at-0}) решается до начала процесса управления и позволяет дать априорную оценку качества этого процесса.




В каждом конкретном процессе управления реализуется некоторая  траектория $\{u^p, y^p\} = \{u^p(t), y^p(t)\}_{t=0}^{T-1}$ системы $G$, которая определяется реализовавшимся, но наблюдателю неизвестным начальным состоянием $x_0^p\in X_0$ и поданным на вход системы  (\ref{model}) управлением $u^p$. Далее будем считать, что в процессе управления доступны лишь неточные измерения выходных сигналов вида
$$
    \tilde{y}^p(t) = y^p(t) + \xi(t), \ \  t = 0, \ldots, T - 1,
     $$
где $\xi(t)$ ---  ошибка измерения в момент времени $t$.
Величина реализовавшейся ошибки $\xi(t)$ достоверно неизвестна, однако полагаем ее в дальнейшем принадлежащей известному множеству $\Xi = \{ \xi \in \mathbb{R}^p :  ||\xi||_{\infty} \leq \varepsilon \}$, т.е. $\xi(t) \in \Xi$, $t = 0, \ldots, T - 1$, где $||\cdot||_{\infty}$ --- равномерная норма.


К некоторому моменту времени $\tau$ пара $\{u^p_\tau, \tilde y^p_\tau\} = \{u^p(t), \tilde y^p(t)\}_{t=0}^{\tau-1}$ из реализовавшихся в рассматриваемом процессе управления и измерений составляет текущую позицию процесса. Она позволяет оценить реализовавшееся начальное состояние, скорректировать будущее управление и улучшить априорную оценку качества процесса управления, которую дает задача (\ref{oc-at-0}).

\begin{definition}\label{def:4-1}
Состояние $x(\tau)$ назовем согласующимся c позицией $\{u_\tau^p, \tilde y^p_\tau\}$, если найдутся такие допустимые начальное состояние $x_0 \in X_0$ и ошибки измерения $\xi(t) \in \Xi$, $t = 0, \ldots, \tau - 1$, что выполняются тождества
$$
    x(\tau) = x(\tau |x_0, u_\tau^p),\ \
    \tilde y^p(t) = Cx(t | x_0, u_t^p) + Du^p(t) + \xi(t), \ \
    t = 0, \ldots, \tau -1,
    $$
где $x(t|x_0, u_t^p)$ --- состояние, в которое система (\ref{model}) приходит в момент $t$, двигаясь из начальной точки $x(0) = x_0$ под воздействием управления $u_t^p$.
\end{definition}

Отметим, что начальное состояние $x_0$, о котором идет речь в определении 1, порождает траекторию $\{u_\tau^p, y_\tau\}$, в которой, возможно, $y_\tau \ne y^p_\tau$.

Обозначим через $X(\tau, u_\tau^p, \tilde y^p_\tau)$ множество всех состояний $x(\tau)$, согласующихся с измеренной траекторией $\{u_\tau^p, \tilde y^p_\tau\}$. В момент времени  $\tau$ сформулируем  задачу оптимального  управления:
\begin{align}\label{oc-at-tau}
        \min_{u}  \ \ &  \sum_{t=\tau}^{T-1} ||u(t)||^2, \\
               &   x(t+1) = Ax(t)+Bu(t), \nonumber\\
               &   y(t) = Cx(t)+Du(t), \nonumber\\
               &   u(t)\in U, \ \ y(t) \in  Y(t)\ \
                \forall x(\tau)\in X(\tau, u_\tau^p, \tilde y^p_{\tau}), \nonumber\\
               & t=\tau,\ldots, T-1. \nonumber
\end{align}


Пусть $u^*(t|\tau, u_\tau^p, \tilde{y}_\tau^p)$, $t = \tau, \ldots, T-1$, --- оптимальное  управление в задаче (\ref{oc-at-tau}). Согласно \cite{Dmitruk2004},  в момент $\tau$  на вход системы $G$ подается  первое значение оптимального управления
\begin{equation}\label{fb0}
    u^p(\tau) = u^*(\tau|\tau, u_\tau^p, \tilde{y}_\tau^p),
    \end{equation}
после чего в момент $\tau + 1$ решается следующая задача оптимального программного управления (\ref{oc-at-tau}), в которой на единицу уменьшается горизонт управления и обогащается знание о поведении системы за счет новой позиции $\{u_{\tau+1}^p, \tilde{y}_{\tau+1}^p\}.$

Управление $u^p(\tau)$, $\tau = 0, \ldots, T-1$, построенное по правилу (\ref{fb0}) представляет собой \cite{Dmitruk2004} \textit{реализацию в конкретном процессе управления оптимальной обратной связи по неточным измерениям}.

Таким образом, для оптимального управления системой $G$ по неточным измерениям ее выходных сигналов при наличии модели системы необходимо в каждый момент $\tau$ решать задачу (\ref{oc-at-tau}). Ee решение основано на принципе разделимости процессов управления и наблюдения (см., например, \cite{Kurzhanskii97}).  Для рассматриваемой задачи можно применить результаты работы  \cite{Dmitruk2004}, модифицируя их с учетом нового типа ограничений и дискретности динамической системы. Соответствующая модификация приводится  в Приложении к данной работе.


\section{Оптимальное гарантированное управление линейной системой \\ на основе данных}
Далее сосредоточимся на задаче управления системой $G$, однако условимся, что реализация $(A,B,C,D)$ системы в пространстве состояний не известна. Классический подход в подобных ситуациях состоит в предварительной идентификации системы и последующей формулировке и решении задачи из разд. 2.

В настоящей работе будет предложен альтернативный подход, не нуждающийся в явном параметрическом представлении системы. Вместо модели $(A,B,C,D)$ будем использовать полученное в \cite{BerberichAllgower} представление любой траектории системы $G$ на основе одной предварительно сгенерированной траектории из управления и выходного сигнала
$$
    \{u^d, y^d\} = \{u^d(t), y^d(t)\}_{t = 0}^{T^d - 1},
     $$
которую далее будем называть априорной траекторией.


Будем считать, что  априорная траектория $\{u^d, y^d\}$ измерена точно и для системы $G$ дана верхняя оценка размерности ее состояния $n$ (см. \cite{BerberichAllgower}).



\subsection{Информативность априорной траектории}
Предварительно приведем результаты работ \cite{Willems, BerberichAllgower}, в которых показано, как априорная траектория $\{u^d, y^d\}$ при определенных условиях может иметь ту же информационную ценность, что и модель системы $(A,B,C,D)$.

\begin{definition}\label{persistency exciting}
Пусть $L,L^d \in \mathbb{N}$, $L \leq L^d$. Управление $u = \{u(t)\}_{t=0}^{L^d-1}$ называется постоянно возбуждающим порядка $L$, если  матрица Ганкеля
$$
H_L(u) =
\begin{pmatrix}
  u(0) & u(1) & \cdots & u(L^d-L)\\
  u(1) & u(2) & \cdots & u(L^d-L+1)\\
  \vdots & \vdots & \ddots & \vdots \\
  u(L-1) & u(L) & \cdots & u(L^d-1)
\end{pmatrix}
$$
имеет полный строчный ранг, т.е. ${\rm rank}\, H_L(u) = mL$.
\end{definition}

\begin{remark}\label{remark on input length}
Если управление $u$ является постоянно возбуждающим порядка $L$, то оно должно быть достаточно длинным. Поскольку матрица $H_L(u)\in \mathbb{R}^{mL \times (L^d - L + 1)}$ имеет полный строчный ранг, число строк не   превышает число столбцов: $L^d - L + 1 \geq mL$. Отсюда следует необходимое условие на длину $L^d$ постоянно возбуждающего управления порядка $L$: $L^d \geq L(m+1) - 1$.
\end{remark}

Согласно \cite{Willems, BerberichAllgower}, априорная траектория $\{u^d, y^d\}$, порожденная постоянно возбуждающим управлением достаточно высокого порядка, содержат информацию, достаточную для представления любой траектории системы $G$. Далее будем использовать следующий результат работы \cite{Willems}, сформулированный в \cite{BerberichAllgower} в терминах  классических моделей в пространстве состояний:
\begin{theorem}\label{trajectory check}
Пусть $\{u^d, y^d\} = \{u^d(t), y^d(t)\}_{t=0}^{T^d-1}$ --- априорная траектория линейной системы $G$ размерности $n$, причем $u^d$ --- постоянно возбуждающее управление порядка $T+n$. Тогда $\{u, y\} = \{u(t), y(t)\}_{t=0}^{T-1}$ является траекторией $G$ в том и только в том случае, когда для
$$%\begin{equation}
\begin{pmatrix}
H_T(u^d) \\
H_T(y^d)
\end{pmatrix} \alpha = \begin{pmatrix}
u \\
y
\end{pmatrix}
$$%\end{equation}
существует решение $\alpha \in \mathbb{R}^{T^d-T+1}.$
\end{theorem}

Теорема \ref{trajectory check} позволяет проверять любую пару $\{u,y\}$ на принадлежность множеству траекторий системы $G$.
В дальнейшем будем использовать условия теоремы для построения множества возможных траекторий $\{u^p_\tau, u, y^p_\tau, y\}$ длины $T$ с некоторой фиксированной "прошлой"\ частью $\{u^p_\tau, y^p_\tau\} = \{u^p(t), y^p(t)\}_{t=0}^{\tau-1}$ длины $\tau$ и нефиксированной "будущей"\ частью  $\{u, y\} = \{u(t), y(t)\}_{t=\tau}^{T-1}$. Для этого будем делить на "прошлое"\ и "будущее"\ для момента $\tau$ и строки матриц Ганкеля для априорной траектории:
$$
H_T(u^d) = \begin{pmatrix}
  u^d(0) & \cdots & u^d(T^d-T)\\
  \vdots & \ddots & \vdots \\
  u^d(\tau-1) & \cdots & u^d(\tau-1 + T^d - T) \\
  \hline
  u^d(\tau) & \cdots & u^d(\tau + T^d-T)\\
  \vdots & \ddots & \vdots \\
  u^d(T-1) & \cdots & u^d(T^d-1)
\end{pmatrix} =
		\begin{pmatrix}
		U_{\tau}^p \\
		U_{\tau}^f
		\end{pmatrix},
    $$
$$
H_T(y^d) = \begin{pmatrix}
  y^d(0) & \cdots & y^d(T^d-T)\\
  \vdots & \ddots & \vdots \\
  y^d(\tau-1) & \cdots & y^d(\tau-1 + T^d - T) \\
  \hline
  y^d(\tau) & \cdots & y^d(\tau + T^d-T)\\
  \vdots & \ddots & \vdots \\
  y^d(T-1) & \cdots & y^d(T^d-1)
\end{pmatrix} =
		\begin{pmatrix}
		Y_{\tau}^p \\
		Y_{\tau}^f
		\end{pmatrix}.
    $$

Если управление $u^d$ является постоянно возбуждающим порядка $T+n$, то, согласно теореме \ref{trajectory check}, $\{u_{\tau}^p, u, y_{\tau}^p, y\}$ является траекторией системы $G$ тогда и только тогда, когда уравнение
\begin{equation}\label{traj-cond}
\begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f \\
Y_{\tau}^f
\end{pmatrix} \alpha(\tau) = \begin{pmatrix}
u_{\tau}^p \\
y_{\tau}^p \\
u \\
y
\end{pmatrix}
\end{equation}
имеет решение $\alpha(\tau)\in \mathbb{R}^{T^d - T +1}$.

В силу теоремы \ref{trajectory check}, для любых $u^p_\tau, y^p_\tau, u$ можно найти хотя бы один возможный выходной сигнал $y$, но для единственности $y$, которая представляет особый практический интерес, необходимо наложить дополнительные условия. При условии наблюдаемости пары $(A,C)$, траектория $\{u^p, y^p\}$ длины $n$ однозначно определяет начальное состояние, поэтому для обеспечения единственности достаточно потребовать $\tau \geq n$.


\subsection{Принцип разделимости}
Найдем аналог принципа разделимости управления и наблюдения для линейных систем с известной моделью в пространстве состояний для случая, когда траектория системы $G$ представлена в виде (\ref{traj-cond}). Будем следовать идее декомпозиции будущего выходного сигнала $y$ (см. Приложение)
\begin{equation}\label{DBOC-y-separation}
    y =  y_0 + \hat y,
    \end{equation}
где $y_0 = \{y_0(t)\}_{t=\tau}^{T-1}$ --- выходной сигнал системы $G$, соответствующий управлению $u$ и тривиальному начальному условию $x(\tau) = 0$; $\hat y = \{\hat y(t)\}_{t=\tau}^{T-1}$ --- выходной сигнал неуправляемой системы $G$ для некоторого начального условия $x(\tau)$, согласующегося с текущей позицией процесса $\{u_\tau^p, y_\tau^p\}$.

Рассмотрим подробно слагаемые в (\ref{DBOC-y-separation}). При определении $y_0$ тривиальное начальное состояние  $x(\tau)=0$ можно зафиксировать неявно посредством тривиальной прошлой траектории $\{0,0\}$ длины не менее $n$. С тривиальной траекторией, очевидно, согласуется начальное условие $x(0)=0$, а поскольку $\tau \geq n$, это единственно возможное начальное состояние. Тогда система остается в начале координат вплоть до момента $\tau$: $x(t)=0$, $t=0, \ldots, \tau$. Из рассуждений следует, что $\{0, u, 0, y_0\}$ является траекторией длины $T$ системы $G$.



Далее $\{0,\hat y\}$ --- траектория системы $G$ c начальным условием  $x(\tau)$ из множества состояний, в которые система могла прийти, точно следуя траектории $\{u_\tau^p, y_\tau^p\}$, где о выходном сигнале $y_\tau^p$ известно только, что он отклоняется от измеренного $\tilde y_\tau^p$ в равномерной норме не более чем на $\varepsilon$. Тогда $\{u_{\tau}^p, 0, y_{\tau}^p, \hat{y}\}$ --- траектория длины $T$ системы $G$.

Из необходимого условия теоремы \ref{trajectory check} следует, что для траекторий $\{0, u, 0, y_0\}$ и $\{u_{\tau}^p, 0, y_{\tau}^p, \hat{y}\}$ существуют $ \alpha_0(\tau), \hat \alpha(\tau)$, соответственно, удовлетворяющие
\begin{equation}\label{two traj}
\begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f \\
Y_{\tau}^f
\end{pmatrix} \alpha_0(\tau) = \begin{pmatrix}
0 \\
0 \\
u \\
y_0
\end{pmatrix},
 \quad
 \begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f \\
Y_{\tau}^f
\end{pmatrix} \hat{\alpha}(\tau) = \begin{pmatrix}
u_{\tau}^p \\
y_{\tau}^p \\
0 \\
\hat{y}
\end{pmatrix}.
\end{equation}
Суммируя  равенства  (\ref{two traj}), получаем
\begin{equation}\label{one traj}
\begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f \\
Y_{\tau}^f
\end{pmatrix} (\hat{\alpha}(\tau) + \alpha_0(\tau)) = \begin{pmatrix}
u_{\tau}^p \\
y_{\tau}^p \\
u \\
\hat{y} + y_0
\end{pmatrix}.
\end{equation}
В силу теоремы \ref{trajectory check}, условие (\ref{one traj}) является достаточным для того, чтобы ${\{u_{\tau}^p, u, y_{\tau}^p, \hat{y} + y_0\}}$ являлась траекторией системы. Поскольку начальное состояние $x_0$ неявно зафиксировано достаточно длинным участком $\{u_{\tau}^p, y_{\tau}^p\}$, эта траектория совпадает с искомой $\{u_{\tau}^p, u, y_{\tau}^p, y\}$, т.е. $y = \hat{y} + y_0$. Суммируя рассуждения выше, любую траекторию можно строить согласно лемме:
\begin{lemma}\label{dd-separation}
Пусть $\{u_{\tau}^p, y_{\tau}^p \}$ --- некоторая фиксированная прошлая траектория системы $G$ длины $\tau \geq n$. Тогда любая траектория $\{u_{\tau}^p, u, y_{\tau}^p, y\}$ длины $T$ системы $G$ однозначно представима в виде суммы траекторий $\{0, u, 0, y_0\}$ и $\{u_{\tau}^p, 0, y_{\tau}^p, \hat{y}\}$ длины $T$, причем для фиксированного управления $u$ определить неизвестные будущие участки $y_0, \hat{y}$ можно следующим образом:\\
1. Найти некоторые решения $\hat{\alpha}(\tau)$, $\alpha_0(\tau)$ алгебраичеких уравнений
\begin{equation}\label{cond-lemma}
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
\end{pmatrix} \hat{\alpha}(\tau) = \begin{pmatrix}
u_\tau^p \\
y_\tau^p \\
0 \\
\end{pmatrix}, \quad
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
\end{pmatrix} \alpha_0(\tau) = \begin{pmatrix}
0 \\
0 \\
u \\
\end{pmatrix}.
\end{equation}
2. Вычислить $\hat{y} = Y_\tau^f\hat{\alpha}(\tau)$, $y_0 = Y_\tau^f\alpha_0(\tau)$.
\end{lemma}

\begin{remark}\label{y(t)-from-y}
Для получения $\hat y(t), y_0(t)$ в конкретный момент времени $t$, на шаге 2 необходимо использовать блок $Y^d(t)$ матрицы $Y_\tau^f$ (или $H_T(y^d)$):
$$
     Y^d(t) = (y^d(t), y^d(t+1), \ldots, y^d(t+T^d-T)).
     $$
Получим $\hat y(t) = Y^d(t)\hat \alpha(\tau)$, $y_0(t) = Y^d(t) \alpha_0(\tau)$.
\end{remark}


По аналогии с определением~\ref{def:4-1} дадим
\begin{definition} Назовем параметр $\hat\alpha(\tau)$ согласующимся с позицией $\{u^p_\tau, \tilde y_\tau^p\}$ если
\begin{equation*}\label{DBOC-hat-alpha}
    \begin{pmatrix}
        U_\tau^p \\
        Y_\tau^p \\
        U_\tau^f \\
        \end{pmatrix} \hat{\alpha}(\tau) = \begin{pmatrix}
        u_\tau^p \\
        y_\tau^p \\
        0 \\
        \end{pmatrix}, \ \
    ||y^p(t) - \tilde y^p(t)||_{\infty} \le \varepsilon, \ \
     t = 0, \ldots, \tau-1.
\end{equation*}
\end{definition}

Пусть ${\cal A}(\tau, u_\tau^p, \tilde y_{\tau}^p)$ --- множество всех $\hat \alpha(\tau)$, согласующихся с  $\{u^p_\tau, \tilde y^p_\tau\}$:
\begin{align*}
    {\cal A}(\tau, u_\tau^p, \tilde y^p_\tau) = \bigg\{ \hat \alpha(\tau)\in \mathbb{R}^{T^d-T+1} : & \ \  U_\tau^p\hat{\alpha}(\tau) = u^p_\tau,  \ \ U^f_\tau\hat{\alpha}(\tau) = 0, &\\
    & -\varepsilon \mathbbm{1} \le Y^p_\tau\hat{\alpha}(\tau) -\tilde y^p_\tau \le  \varepsilon\mathbbm{1}\bigg\}, &
    \end{align*}
где $\mathbbm{1}$ --- $m(T-\tau)$-вектор из единиц.
Множество ${\cal A}(\tau, u_\tau^p, \tilde y^p_\tau)$ --- аналог множества $X(\tau, u_\tau^p, \tilde y^p_\tau)$ состояний $x(\tau)$, согласующихся с текущей позицией $\{u_\tau^p, \tilde y^p_\tau\}$.



Далее определим ${\cal Y}(t| \tau, u_\tau^p, \tilde y^p_\tau)$ как множество всех $\hat y(t)$, согласующихся с позицией $\{u^p_\tau, \tilde y^p_\tau\}$. В соответствии с замечанием \ref{y(t)-from-y}, это множество порождается множеством ${\cal A}(\tau, u_\tau^p, \tilde y_{\tau}^p)$:
$$
    {\cal Y}(t | \tau, u_\tau^p, \tilde y^p_\tau) = \bigg\{ \hat y(t) = Y^d(t) \hat \alpha(\tau) :  \  \hat \alpha(\tau) \in {\cal A}(\tau, u_\tau^p, \tilde y^p_\tau)\bigg\}.
    $$

В связи с  декомпозицией (\ref{DBOC-y-separation}) выходного сигнала, ограничение (\ref{constraints}) в момент $t$ принимает вид
$G(t)(y_0(t)+\hat y(t)) \leq g(t)$. Тогда  на $y_0(t)$ наложим "суженное"{} условие:
\begin{equation}\label{tightened constraint}
G(t)y_0(t) \leq g(t)-\chi(t|\tau),
\end{equation}
где  $\chi(t|\tau) = (\chi_i(t|\tau), i = 1,\ldots, q)$ соответствует наихудшей реализации выходного сигнала $\hat y(t)$ в позиции $\{u_\tau^p, \tilde y^p_\tau\}$, а именно, каждый его элемент $\chi_i(t|\tau)$ является решением задачи
\begin{equation} \label{estimation-set-description}
    \chi_i(t|\tau) = \max\limits_{\hat{y}(t)} \ G_i(t)\hat{y}(t), \ \
    \hat{y}(t) \in {\cal Y}(t| \tau, u_\tau^p, \tilde y_{\tau}^p),
\end{equation}
где $G_i(t)$ --- $i$-ая строка матрицы $G(t).$

С учетом определений множеств ${\cal Y}(t| \tau, u_\tau^p, \tilde y_{\tau}^p)$, ${\cal A}(\tau, u_\tau^p, \tilde y_{\tau}^p)$, задачи (\ref{estimation-set-description}) представляют собой  задачи линейного программирования:
\begin{align} \label{estimation-lp}
    \chi_i(t|\tau) =  & \max\limits_{\hat\alpha(\tau)} \ G_i(t)Y^d(t)\hat{\alpha}(\tau), \\
    & \begin{pmatrix}
        U_\tau^p \\
        U_\tau^f \\
        \end{pmatrix} \hat{\alpha}(\tau) = \begin{pmatrix}
        u_\tau^p \\
        0 \\
        \end{pmatrix}, \nonumber \\
    & \tilde{y}_{\tau}^p-\varepsilon \mathbbm{1} \leq Y_\tau^p \hat{\alpha}(\tau) \leq \tilde{y}_\tau^p + \varepsilon \mathbbm{1}. \nonumber
    \end{align}
Задачи (\ref{estimation-lp}) --- \textit{задачи оптимального наблюдения}, см. \cite{Dmitruk2004} и Приложение.


Выполнение  для $y_0(t)$  ограничения (\ref{tightened constraint}) очевидно влечет удовлетворение исходного ограничения (\ref{constraints}) на $y(t)$ для любой возможной реализации $\hat{y}(t)$,  согласующейся с позицией $\{u^p_\tau, \tilde y^p_\tau\}$.

Параметр $\alpha_0(\tau)$, удовлетворяющий второму из условий (\ref{cond-lemma}) и такой, что для $y_0(t) = Y^d(t)\alpha_0(\tau)$ при всех $t = \tau, \ldots, T-1$ выполняется неравенство (\ref{tightened constraint}), определяет допустимое управление $u = U_\tau^f \alpha_0(\tau)$. Тогда \textit{ задача  оптимального управления} в момент времени $\tau$ имеет вид:
\begin{align}\label{control}
\min\limits_{\alpha_0(\tau), u} \ & \norm{u}^2, \\
    & \begin{pmatrix}
    U_\tau^p \\
    Y_\tau^p \\
    U_\tau^f \\
    \end{pmatrix} \alpha_0(\tau) = \begin{pmatrix}
    0 \\
    0 \\
    u \\
    \end{pmatrix},\nonumber \\
    & G(t)Y^d(t)\alpha_0(\tau) \leq g(t) - \chi(t|\tau), \nonumber \\
    & u_{\min} \leq u(t) \leq u_{\max},  \ \ t = \tau, \ldots, T-1.\nonumber
    \end{align}



Исключая в (\ref{control}) управление $u$, получаем задачу квадратичного программирования относительно $\alpha_0(\tau)$:
\begin{align}\label{control-qp}
    \min\limits_{\alpha_0(\tau)} \ & \alpha_0(\tau)^T(U_{\tau}^f)^TU_{\tau}^f\alpha_0(\tau), \\
    & \begin{pmatrix}
        U_\tau^p \\
        Y_\tau^p \\
    \end{pmatrix} \alpha_0(\tau) = \begin{pmatrix}
    0 \\
    0 \\
    \end{pmatrix},\nonumber \\
    & G(t)Y^d(t)\alpha_0(\tau) \leq g(t)- \chi(t|\tau), \nonumber\\
    & u_{\min} \leq U^d(t)\alpha_0(\tau) \leq u_{\max}, \ \
        t = \tau, \ldots, T-1, \nonumber
\end{align}
где, по аналогии с $Y^d(t)$,  $U^d(t) = (u^d(t), u^d(t+1), \ldots, u^d(t+T^d-T))$.


Пусть  $\alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)$ --- решение задачи  оптимального управления (\ref{control-qp}). На вход системы $G$ подаем первое значение соответствующего управления (см. (\ref{fb0})), которое вычисляется согласно формуле $u^*(\tau|\tau, u_\tau^p, \tilde{y}_\tau^p) = U^d(\tau)\alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)$.



Таким образом, алгоритм управления системой на основе априорных данных $\{u^d, y^d\}$ состоит в следующем

\noindent при всех $\tau = n,\ldots, T-1$:

1) решить задачи (\ref{estimation-lp}), найти оценки $\chi_i(t|\tau)$, $i = 1, \ldots, q$, $t = \tau, \ldots, T-1$;

2) решить задачу (\ref{control-qp}), найти  $\alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)$;

3) подать на вход системы управление $u^p(\tau) = U^d(\tau)\alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)$.

Как и в разд.~\ref{model-based problem}, полученное в результате применения алгоритма управление $u^p(\tau)$, $\tau = n, \ldots, T-1$, является \textit{реализацией в конкретном процессе управления оптимальной обратной связи по неточным измерениям}.


Для того, чтобы результаты представленного алгоритма совпадали с результатом разд. \ref{model-based problem} необходимо потребовать  $X_0 = \mathbb{R}^n$, совпадения управлений $u^p(t)$ при $t = 0,1,\ldots, n-1$,  и также начинать процесс управления в момент $\tau = n$.


\subsection{Основная теорема}


Дадим теоретическое обоснование реализуемости предложенного алгоритма управления. В частности, покажем, что при условии существования решений задач (\ref{estimation-lp}) и (\ref{control}) в момент времени $\tau = n$, решения этих задач существуют и для всех $\tau = n+1, \ldots, T-1$. С целью сокращения записи далее  опустим явное упоминание пары $\{u^p_\tau, \tilde y^p_\tau\}$ в решениях задачи (\ref{control-qp}) для момента $\tau$, т.е.
$\alpha_0^*(\tau) = \alpha_0^*(\tau, u^p_\tau, \tilde y^p_\tau)$,
$u^*(\tau|\tau) = u^*(\tau|\tau, u^p_\tau, \tilde y^p_\tau)$, а также для момента $\tau+1$ и позиции $\{u^p_\tau, u^*(\tau|\tau), \tilde y^p_\tau, \tilde y^p(\tau)\}$, которая реализуется при подаче управления $u^*(\tau|\tau) = u^p(\tau)$ в момент $\tau$.

\begin{theorem}\label{main-theorem}
Пусть в момент $\tau$ для позиции $\{u^p_\tau, \tilde y^p_\tau\}$ каждая из задач (\ref{estimation-lp}) имеет решение. Далее, пусть имеет решение задача (\ref{control-qp}) с параметрами $\chi(t|\tau)$, поставленными решениями задач (\ref{estimation-lp}). Тогда в момент $\tau+1$ для позиции $\{u^p_\tau, u^*(\tau|\tau), \tilde y^p_\tau, \tilde y^p(\tau)\}$
задачи (\ref{estimation-lp}), (\ref{control-qp})   также имеют решение. Более того, $$
    \sum\limits_{t=\tau+1}^{T-1}\norm{u^*(t|\tau+1)}^2 \leq \sum\limits_{t=\tau+1}^{T-1}\norm{u^*(t|\tau)}^2.
    $$
\end{theorem}

\begin{proof} Сначала докажем разрешимость каждой из задач оптимального наблюдения в момент $\tau+1$. Эти задачи можно записать в виде
\begin{align}\label{estimation-lp-tau+1}
    \chi_i(t|\tau+1) = & \max\limits_{\hat{\alpha}(\tau+1)} G_i(t)Y^d(t)\hat{\alpha}(\tau+1), \\
    & \begin{pmatrix}
        U_{\tau}^p \\
        U^d(\tau)\\
        U_{\tau+1}^f
    \end{pmatrix} \hat{\alpha}(\tau+1) =
    \begin{pmatrix}
        u_{\tau}^p \\
        u^*(\tau|\tau)\\
        0
    \end{pmatrix}, \nonumber \\
    & \tilde{y}_{\tau}^p-\varepsilon \mathbbm{1} \leq
    Y_{\tau}^p \hat\alpha(\tau+1) \leq
    \tilde{y}_{\tau}^p + \varepsilon \mathbbm{1}, \nonumber \\
    & \tilde y^p(\tau) - \varepsilon \mathbbm{1} \leq
    Y^d(\tau) \hat \alpha(\tau+1) \leq
    \tilde y^p(\tau) + \varepsilon \mathbbm{1}, \nonumber
\end{align}
а задачи наблюдения для момента $\tau$ представимы в виде
\begin{align}\label{estimation-lp-tau}
    \chi_i(t|\tau) = & \max\limits_{\hat{\alpha}(\tau)} G_i(t)Y^d(t)\hat{\alpha}(\tau), \\
    & \begin{pmatrix}
        U_{\tau}^p \\
        U^d(\tau)\\
        U_{\tau+1}^f \\
    \end{pmatrix} \hat{\alpha}(\tau) =
    \begin{pmatrix}
        u_{\tau}^p \\
        0\\
        0 \\
    \end{pmatrix}, \nonumber \\
    & \tilde{y}_{\tau}^p-\varepsilon \mathbbm{1} \leq
    Y_{\tau}^p \hat\alpha(\tau) \leq
    \tilde{y}_\tau^p + \varepsilon \mathbbm{1}.\nonumber
\end{align}

Каждая задача (\ref{estimation-lp-tau+1}) допустима, поскольку для истинной реализовавшейся траектории $\{u^p_\tau, u^*(\tau|\tau), y^p_\tau, y^p(\tau)\}$ и будущего тривиального управления $\{u(t)\}_{t=\tau+1}^T = 0$ существует $\hat\alpha^p(\tau+1)$, для которого выполняется второе из условий (\ref{cond-lemma}) Леммы \ref{dd-separation}, а значит, для этого $\hat\alpha^p(\tau+1)$ удовлетворены все ограничения (\ref{estimation-lp-tau+1}).

Для доказательства разрешимости задачи (\ref{estimation-lp-tau+1})
используем решение $\alpha_0^*(\tau)$  задачи оптимального управления (\ref{control-qp}) в момент $\tau$.
Обозначим
\begin{equation}\label{uc}
    u^c = U^f_{\tau+1}\alpha_0^*(\tau),\ \
    y_0^*(\tau|\tau) = Y^d(\tau)\alpha_0^*(\tau).
    \end{equation}
Заметим, что $u^c = \{u^*(t|\tau)\}_{t = \tau+1}^{T-1}$, т.е. это "хвост"{} оптимального управления задачи (\ref{control-qp}). Согласно Лемме \ref{dd-separation} существует $\alpha^c$, такое что выполняется равенство
\begin{equation}\label{alpha_0-candidate}
\begin{pmatrix}
U_{\tau}^p \\
U^d(\tau)\\
Y_{\tau}^p \\
Y^d(\tau)\\
U_{\tau+1}^f \\
\end{pmatrix} \alpha^c = \begin{pmatrix}
0\\
0\\
0\\
0\\
u^c\\
\end{pmatrix}.
\end{equation}

Сдвинем переменную ${\hat \alpha(\tau+1)}$, относительно которой поставлены задачи оптимального наблюдения (\ref{estimation-lp-tau+1}), на константу, перейдем к новой переменной $\Delta\alpha(\tau+1)$:
$$
    \hat \alpha(\tau+1) = \alpha_0^*(\tau)-\alpha^c+\Delta\alpha(\tau+1).
    $$
Тогда
$$
    \chi_i(t|\tau+1) = G_i(t)Y^d(t)(\alpha_0^*(\tau)-\alpha^c) +
    \Delta \chi_i(t|\tau+1),
    $$
где, с учетом (\ref{uc}), (\ref{alpha_0-candidate}),
\begin{align}
    \Delta\chi_i(t|\tau+1) = & \max_{\Delta\alpha(\tau+1)} G_i(t)Y^d(t)\Delta\alpha(\tau+1),
    \label{estimation-delta-alpha} \\
    & \begin{pmatrix}
        U_\tau^p \\
        U^d(\tau)\\
        U_\tau^f \\
    \end{pmatrix} \Delta\alpha(\tau+1) =
    \begin{pmatrix}
        u_\tau^p \\
        0 \\
        0\\
    \end{pmatrix},
    %\label{u-delta-alpha}
    \nonumber \\
    & \tilde{y}_{\tau}^p-\varepsilon \mathbbm{1}  \leq
    Y_\tau^p \Delta \alpha(\tau+1)
    \leq \tilde{y}_\tau^p + \varepsilon \mathbbm{1}, %\label{y-delta-alpha}
    \nonumber\\
    & \tilde y^p(\tau)-y_0^*(\tau|\tau) - \varepsilon \mathbbm{1} \leq Y^d(\tau) \Delta \alpha(\tau+1)
    \leq \tilde y^p(\tau)-y_0^*(\tau|\tau) +  \varepsilon \mathbbm{1},
    \label{estimation-new-constraint}
\end{align}
и множество допустимых решений $\Delta \alpha(\tau+1)$ непустое.


Сравним задачи (\ref{estimation-delta-alpha}) -- (\ref{estimation-new-constraint}) для $\Delta \alpha(\tau + 1)$ и (\ref{estimation-lp-tau}) для $\hat \alpha (\tau)$. Очевидно, что  дополнительное ограничение (\ref{estimation-new-constraint}) влечет $\Delta\chi_i(t|\tau+1) \le \chi_i(t|\tau)$ и справедлива оценка
\begin{equation}\label{chi-bound}
    \chi_i(t|\tau+1) \le G_i(t)Y^d(t)(\alpha_0^*(\tau)-\alpha^c) +
    \chi_i(t|\tau),
\end{equation}
для всех $i = 1, \ldots, q$, $t = \tau+1, \ldots, T-1$.

Таким образом, доказано, что в момент $\tau+1$ все задачи оптимального наблюдения имеют решение.


Остается продемонстрировать, что множество допустимых решений $\alpha_0(\tau+1)$ в задаче оптимального управления для момента $\tau+1$, которая имеет вид
\begin{align}
    \min\limits_{\alpha_0(\tau+1)} \ & \alpha_0(\tau+1)^T(U_{\tau+1}^f)^T U_{\tau+1}^f\alpha_0(\tau+1), %\label{control-qp-tau+1}
    \nonumber \\
    & \begin{pmatrix}
        U_{\tau}^p \\
        U^d(\tau)\\
        Y_{\tau}^p \\
        Y^d(\tau) \\
    \end{pmatrix} \alpha_0(\tau+1) = \begin{pmatrix}
        0 \\
        0\\
        0\\
        0 \\
    \end{pmatrix},  \label{tau+1-eq}\\
    & G(t)Y^d(t)\alpha_0(\tau+1) \leq g(t) - \chi(t|\tau+1),  \label{tau+1-constr-y}\\
    & u_{\min} \leq U^d(t)\alpha_0(\tau+1) \leq u_{\max},\ \
    t = \tau+1, \ldots, T-1, \label{tau+1-constr-u}
\end{align}
непусто --- тогда эта выпуклая задача квадратичного программирования имеет решение.

Покажем, что $\alpha^c$ --- допустимое решение. По построению $\alpha^c$ выполнены ограничения-равенства (\ref{tau+1-eq}) и группа ограничений на управления (\ref{tau+1-constr-u}). Покажем, что выполнены также условия (\ref{tau+1-constr-y}). Воспользовавшись сначала (\ref{chi-bound}), а затем тем фактом, что $\alpha_0^*(\tau)$ удовлетворяет ограничениям задачи (\ref{control-qp}), получаем
\begin{align*}
    G(t) Y^d(t) \alpha^c + \chi(t|\tau+1) & \leq G(t) Y^d(t) \alpha^c +  G(t)Y^d(t)(\alpha_0^*(\tau)-\alpha^c) + \chi(t|\tau) = \\
    & = G(t) Y^d(t)\alpha_0^*(\tau) + \chi(t|\tau) \leq g(t), \ \
    t = \tau+1, \ldots, T-1,
\end{align*}
что доказывает (\ref{tau+1-constr-y}).


Наконец, поскольку решение $\alpha^c$ допустимо, оптимальное решение удовлетворяет
\begin{equation*}
    \sum\limits_{t=\tau+1}^{T-1}\norm{u^*(t|\tau+1)}^2 \leq (\alpha^c)^T (U_{\tau+1}^f)^T U_{\tau+1}^f \alpha^c
    = \sum\limits_{t=\tau+1}^{T-1}\norm{u^*(t|\tau)}^2,
\end{equation*} что завершает доказательство всех утверждений теоремы.
$\Box$
\end{proof}

\begin{corollary}
Если задачи оптимального наблюдения (\ref{estimation-lp}) и управления (\ref{control-qp}) имеют решение в момент времени $\tau=n$, то они разрешимы и в каждый из последующих моментов $\tau = n+1, \ldots, T-1$. При этом критерий качества, значение которого определяется в момент $\tau$ как
$$
    J(\tau) = \sum\limits_{t=0}^{\tau-1}\norm{u^p(t)}^2 + \sum\limits_{t=\tau}^{T-1}\norm{u^*(t|\tau)}^2,
    $$
является невозрастающей функцией от $\tau$.
\end{corollary}

Доказательство теоремы~\ref{main-theorem}  использует "хвост"\ $u^c = \{u^*(t|\tau)\}_{t = \tau+1}^{T-1}$  оптимального управления, полученного в момент $\tau$ не только для доказательства допустимости задачи оптимального управления (как и в случае наличия модели системы), но и для доказательства существования решения задач оптимального наблюдения. Это позволяет учесть взаимосвязь не только между соответствующими задачами для $\tau$ и $\tau+1$, но и между самими задачами для момента $\tau+1$. В частности,  для задач оптимального наблюдения на основе $u^c$ приводится такая верхняя оценка решения $\chi(t|\tau+1)$, которая позволяет продемонстрировать и допустимость управления $\{u^*(t|\tau)\}_{t = \tau+1}^{T-1}$ в задаче оптимального управления для момента $\tau+1$.


\section{Примеры}
Пример 1. Применим предложенный алгоритм для управления следующей системой:
\begin{align}\label{example1}
& x(t+1)  = \begin{pmatrix}
0.9950  & 0.0998\\
-0.0998 & 0.9950
\end{pmatrix}
x(t) + \begin{pmatrix}
0.0050\\
0.0998
\end{pmatrix}u(t), \\
& y(t) = \begin{pmatrix}
1 & 0
\end{pmatrix}x(t), \quad t= 0, \ldots, T-1.\nonumber
\end{align}
Требуется минимизировать величину $\sum_{t=0}^{T-1}\norm{u(t)}^2$ при гарантированном соблюдении ограничений на значения выходных сигналов в последних $15$ временных точках:   $ |y(t)| \leq 0.3,$ $t = T-15, \ldots, T-1$. Доступны управления, для которых $|u(t)| \leq 0.7$,  $t = 0, \ldots, T-1$. Горизонт планирования $T=135$, абсолютное значение ошибки ограничено величиной $\varepsilon = 0.02$.

Управление системой (\ref{example1}) начинается в момент $\tau = n = 2$.

Согласно замечанию \ref{remark on input length}, длина  $T^d$  априорной траектории должна быть не меньше $(n + T)(m + 1) - 1 = 273$. Именно такой, наименьшей подходящей длины, была  сгенерирована незашумленная априорная траектория $\{u^d, y^d\}$, в которой управления $u^d(t),$ $t=0,\ldots,T^d-1$, --- случайные векторы, равномерно распределенные в $[0, 0.8]$.

Пусть в конкретном процессе реализовалось начальное состояние $x_0^p = (5, -2)$. Траектория $\{u^p_2, \tilde{y}^p_2\}$, соответствующая движению системы до начала управления, получена при  $u^p(0)=u^p(1)=0$ и $\xi(t)$, $t=0,1$,  выбранных случайным образом из отрезка $[-\varepsilon, \varepsilon]$.

\begin{figure}[h!]
\centering
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=\linewidth]{2d_final_u.eps}
\caption{}
\label{example1-u}
\end{subfigure}\hfil
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=\linewidth]{2d_final_y.eps}
\caption{}
\label{example1-y}
\end{subfigure}
\caption{Реализованная оптимальная обратная связь (a), соответствующий выходной сигнал (b)}
\end{figure}

На рис. \ref{example1-u} изображена реализация $u^p(\tau)$, $\tau = 0, \ldots, T-1$, оптимальной обратной связи в рассматриваемом процессе. Выходной сигнал (см. рис. \ref{example1-y}) удовлетворяет ограничениям на промежутке от $\tau = 120$ до $\tau=134$. На рис. \ref{example1-x} изображена реализовавшаяся траектория системы (\ref{example1}). Априорная оценка значения критерия качества, полученная в $\tau = 2$ составила $ 46.3322$. В процессе управления значение критерия качества улучшилось до $42.5599$. Наиболее значительное изменение происходит при $\tau = 2, \ldots, 28$. Этот фрагмент приведен на рис. \ref{example1-J}. 

\begin{figure}
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=\linewidth]{2d_final_x.eps}
\caption{}
\label{example1-x}
\end{subfigure}\hfil
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=\linewidth]{2d_final_cost.eps}
\caption{}
\label{example1-J}
\end{subfigure}
\caption{Фазовая траектория (a), изменение критерия качества (b)}
\end{figure}


Пример 2. Рассмотрим задачу оптимального управления для системы, которая была рассмотрена в \cite{BerberichMPC}:
\begin{align}\label{example2}
& x(t+1)  = \begin{pmatrix}
0.921 & 0      & 0.041 & 0\\
0     & 0.918  & 0     & 0.033\\
0     & 0      & 0.924 & 0\\
0     & 0      & 0     & 0.937
\end{pmatrix}
x(t) + \begin{pmatrix}
0.017 & 0.001\\
0.001 & 0.023\\
0     & 0.061\\
0.072 & 0
\end{pmatrix}u(t), \\
& y(t) = \begin{pmatrix}
1 & 0 & 0 & 0\\
0 & 1 & 0 & 0
\end{pmatrix}x(t), \quad t= 0, \ldots, T-1.\nonumber
\end{align}
Снова требуется минимизировать величину $\sum_{t=0}^{T-1}\norm{u(t)}^2$ при следующих ограничениях: $ |y_i(t)| \leq 0.1,$ $t = T-20, \ldots, T-1$, $i=1,2$, и $|u_i(t)| \leq 0.8$,  $t = 0, \ldots, T-1$, $i=1,2$. Положим $T=55$, $\varepsilon = 0.02$.

Отметим, что для данной системы управление можно было бы начать в момент $\tau =2$, поскольку наблюдений при $t=0,1$ достаточно для неявного задания начального условия $x_0$. Однако, поскольку математическая модель неизвестна, известна лишь точная размерность системы, $n=4$, управление системой (\ref{example2}) начинается в момент $\tau = n = 4$.

Управления $u^d(t),$ $t=0,\ldots,T^d-1$ для априорной траектории $\{u^d, y^d\}$ длины $T^d = 176$ (см. замечание \ref{remark on input length}) были сгенерированы как случайные векторы, равномерно распределенные в $[-0.8, 0.8]^2$.

Траектория $\{u^p_4, \tilde{y}^p_4\}$ конкретного процесса была сгенерирована для начального состояния $x_0^p = (4, 0, 1, -1)$ и $u^p(t)$, $\xi(t)$, $t=0,\ldots,3$,  выбранных случайным образом из квадратов $[0, 0.8]^2$, $[-\varepsilon, \varepsilon]^2,$ соответственно.

Рис. \ref{fig:example2} иллюстрирует результаты применения предложенной схемы управления. Априорная оценка значения критерия качества, составлявшая $32.183$,  была улучшена до $21.857$. Начиная с момента $\tau = 29$ изменения не  существенны.

\begin{figure}[htb]
\centering
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=\linewidth]{4du1-6.eps}
\caption{}
\end{subfigure}\hfil
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=\linewidth]{4du2-6.eps}
\caption{}
\end{subfigure}
\medskip
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=\linewidth]{4dy-6.eps}
\caption{}
\end{subfigure}\hfil
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=\linewidth]{4dcost-6.eps}
\caption{}
\end{subfigure}
\caption{Реализация оптимальной обратной связи (a)--(b), соответствующие выходные сигналы (c), изменение критерия качества (d)}
\label{fig:example2}
\end{figure}

\section{Заключение}
Рассмотрена задача оптимального управления линейной стационарной системой при наличии ограничений и несовершенных измерений выходных сигналов. Математическая модель системы в пространстве состояний предполагается неизвестной, доступны только  данные априорных наблюдений за ее поведением в одном процессе управления. В предположении об отсутствии в априорных данных ошибок  обоснован принцип разделимости процессов наблюдения и управления в линейных системах только на основе доступных данных, сформулированы соответствующие задачи оптимального наблюдения и управления, предложен и обоснован алгоритм управления объектом в режиме реального времени на основе данных. Развитие полученных результатов на случай неточных априорных данных является предметом дальнейших исследований.


\appendix{}
Для решения задачи (\ref{oc-at-tau}) из раздела \ref{model-based problem}, аналогично результатам \cite{Dmitruk2004}, используем принцип разделимости процессов управления и наблюдения для линейных систем. С этой целью представим состояние $x(t)$ и выходной сигнал $y(t)$ в виде $x(t) = x_0(t) + \hat{x}(t),$ $y(t) = y_0(t) + \hat{y}(t)$, где $x_0(t), y_0(t)$ соответствуют состоянию и выходу номинальной системы с тривиальным начальным состоянием
\begin{align*}
    & x_0(t+1) = Ax_0(t) + Bu(t), \quad x_0(\tau) = 0, \\
    & y_0(t) = Cx_0(t) + Du(t), \quad t = \tau, \ldots, T-1,
    \end{align*}
а $\hat{x}(t), \hat{y}(t)$ соответствуют состоянию и выходу неуправляемой системы с неопределенным начальным состоянием
\begin{align*}
    & \hat{x}(t+1) = A\hat{x}(t), \quad \hat{x}(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p), \\
    & \hat{y}(t) = C\hat{x}(t), \quad t = \tau, \ldots, T-1.
    \end{align*}
Тогда ограничение на выходные сигналы (\ref{constraints}) в виде
$$
    G(t)(y_0(t) + \hat{y}(t)) \leq g(t), \quad \forall x(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
влечет естественное суженное условие на $y_0(t)$, удовлетворение которого будет гарантировать допустимость выходного сигнала $y(t)$:
\begin{equation*}\label{model-chi}
    y_0(t) \in Y_0(t | \tau) = \{y \in \mathbb{R}^p : G(t)y \leq g(t) - \chi(t|\tau)\},
    \end{equation*}
где каждая компонента $\chi_i(t | \tau)$, $i = 1, \ldots, q$, вектора $\chi(t | \tau)$ соответствует наихудшей реализации состояния $x(\tau)$:
\begin{align*}
    \chi_i(t | \tau)  = & \max\limits_z \ G_i(t)\hat{y}(t), \\
    & \hat{x}(s+1) = A\hat{x}(s), \quad \hat{x}(\tau) = z, \nonumber\\
    & y(s) = C\hat{x}(s), \quad s = \tau, \ldots, t, \nonumber\\
    & z \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    \end{align*}
где $G_i(t)$ обозначает $i$--ю строку матрицы $G(t).$

После вычисления всех оценок $\chi(t|\tau)$, $t = \tau, \ldots, T-1$, оптимальное управление $u^*(t|\tau, u_\tau^p, \tilde{y}_\tau^p)$ получим как решение следующей детерминированной задачи оптимального управления:
\begin{align*}
    \min\limits_u & \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,\\
    & x_0(t+1) = Ax_0(t) + Bu(t), \quad x_0(\tau) = 0,\\
    & y_0(t) = Cx_0(t) + Du(t),\\
    & u(t) \in U, \quad y_0(t) \in Y_0(t | \tau),\\
    & t = \tau, \ldots, T-1.
    \end{align*}

Таким образом, решение задачи (\ref{oc-at-tau}) может быть получено в результате решения $q(T-\tau)$ %$ q(T-\tau+1)$
задач оптимального наблюдения и одной детерминированной задачи  оптимального управления (см. \cite{Dmitruk2004}).



\begin{thebibliography}{10}

\bibitem{Review}
{\it Hou Z.-S., Wang Z.} From model-based control to data-driven control: Survey, classification and perspective // Information Sciences. 2013. V. 235. P. 3--35.

\bibitem{Willems}
{\it Willems J. C., Markovsky I., Rapisarda P., De Moor B. L. M.} A note on persistency of excitation //
Systems \& Control Letters. 2005. V. 54. P. 325--329.

\bibitem{BerberichAllgower}
{\it Berberich J., Allg{\"o}wer F.} A trajectory-based framework for data-driven system analysis and control  // European Control Conference, Saint Petersburg, Russia, 2020. P. 1365--1370.


\bibitem{BerberichMPC}
{\it Berberich J., K{\"o}hler J., M{\"u}ller M. A., Allg{\"o}wer F.} Data-Driven Model Predictive Control with Stability and Robustness Guarantees // IEEE Transactions on Automatic Control. DOI: 10.1109/TAC.2020.3000182.


\bibitem{BerberichRobust}
{\it Berberich J., Romer A., Scherer C. W., Allg{\"o}wer F.} Robust data-driven state-feedback design //
arXiv: 1909.04314. 2019.

\bibitem{Persis}
{\it De Persis C., Tesi P.} Formulas for data--driven control: Stabilization, optimality and robustness // IEEE Transactions on Automatic Control. 2019. V. 65. No.3. P. 909--924.

\bibitem{Romer}
{\it Romer A., Berberich J., K{\"o}hler J., Allg{\"o}wer F.} One--shot verification of dissipativity properties from input--output data //
IEEE Control Systems Letters. 2019. V. 3. No.3. P. 709--714.

\bibitem{Coulson}
{\it Coulson J., Lygeros J., D{\"o}rfler F.} Data-Enabled Predictive Control: In the Shallows of the DeePC //
European Control Conference, Naples, Italy, 2019. P. 307--312.


\bibitem{Dmitruk2004}
{\it Габасов Р., Дмитрук Н.М., Кириллова Ф.М.} Оптимальное управление многомерными системами по неточным измерениям их выходных сигналов // Труды Института математики и механики УрО РАН. 2004  Т. 10. № 2. С. 33--57.


\bibitem{Kurzhanskii97}
{\it Kurzhanskii A. B., V\'{a}lyi I.}
Ellipsoidal calculus for estimation and control. Nelson Thornes, 1997.
\end{thebibliography}


\AdditionalInformation{Дмитрук Н.М.}{заведующий кафедрой методов оптимального управления, факультет прикладной математики и информатики, Белорусский государственный университет, Минск}{dmitrukn@bsu.by}

\AdditionalInformation{Манжулина Е.А.}{студентка,  факультет прикладной математики и информатики, Белорусский государственный университет, Минск}{fpm.manzhuli@bsu.by}


\end{document}
