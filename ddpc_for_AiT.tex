%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  Sample document for preparing papers to  "Avtomatika i Telemekhanika"
%%  charset=windows-1251
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[12pt]{a&t}
\usepackage{graphicx}

%added by Lizaveta
\newcommand{\bigzero}{\mbox{\normalfont\Large\bfseries 0}}
\newcommand{\rvline}{\hspace*{-\arraycolsep}\vline\hspace*{-\arraycolsep}}
\usepackage{bbm}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\usepackage{float}

%added by Nat
\usepackage{xcolor}


\begin{document}  %%%!!!

\year{2020}
\title{ОПТИМАЛЬНОЕ УПРАВЛЕНИЕ ЛИНЕЙНЫМИ СТАЦИОНАРНЫМИ СИСТЕМАМИ БЕЗ ПРЕДВАРИТЕЛЬНОЙ ПАРАМЕТРИЧЕСКОЙ ИДЕНТИФИКАЦИИ СИСТЕМЫ}
%\thanks{Работа выполнена при финансовой поддержке \dots
%(грант \mbox{№\,\dots}).}

\authors{Н.М.~ДМИТРУК, канд.~физ.-мат.~наук (dmitrukn@bsu.by),\\
Е.А.~МАНЖУЛИНА (fpm.manzhuli@bsu.by)\\
(Белорусский государственный университет, Минск)}
%Т.Т.~ТРЕТИЙ\\
%(место работы, если отличается от места работы Ч.Ч. Четвертого),\\
%Ч.Ч.~ЧЕТВЕРТЫЙ\\
%(место работы, например, Институт проблем управления
%им.~В.А.~Трапезникова РАН, Москва)}

\maketitle

\begin{abstract}
{\color{blue} Целью работы является решение задачи оптимального управления по неточным выходным сигналам при условии гарантированного удовлетворения геометрических ограничений на выходные сигналы в случае отсутствия параметрической модели системы. Объектом исследования является линейная стационарная дискретная система. В процессе работы был получен метод решения поставленной задачи, опирающийся на наблюдаемые траектории входного и выходного сигналов системы. Новизна предложенного метода состоит в отсутствии шага параметрической идентификации системы, который обычно предшествует решению задачи управления в случае неизвестной системы.}
\end{abstract}


\section{Введение}
В современном мире неумолимо возрастает размерность и общая сложность систем управления. Моделирование многих процессов представляется чрезмерно трудоемким, а построенная модель зачастую слишком сложна и громоздка для практического использования. В последние годы все большую популярность набирают методы системного анализа и управления, базирующиеся не на достоверном знании внутренней организации системы (ее модели), но лишь на ее наблюдаемом поведении (измеренных выходных сигналах) \cite{Review}. В западной литературе новые методы получили название data-driven control methods, т.е. методы управления на основе данных. Настоящая работа примыкает к направлению в рамках теории управления на основе данных, истоки которого находятся в так называемой поведенческой (бихевиористской) теории динамических систем \cite{BehavioralTheory}. Мы будем опираться на результаты работы \cite{Willems}, согласно которой пространство всех траекторий дискретной линейной стационарной системы порождается сдвигами по времени (образующими матрицу Ганкеля) записанных в одном единственном процессе наблюдения траекторий при условии постоянно возбуждающего входного сигнала, и на развитие этих результатов в \cite{BerberichAllgower} для описания систем в пространстве состояний. В качестве примеров успешного использования результатов \cite{BerberichAllgower} отметим работы по методам стабилизации линейных стационарных систем \cite{BerberichMPC}, \cite{Persis}, \cite{BerberichRobust}, а также одношаговый метод проверки системы на диссипативность \cite{Romer}. Некоторые результаты получены и для нелинейных систем \cite{Copp} {\color{red} не уверена, что ссылка верная} {\color{blue} в этих работах что-то есть, но, возможно, лучше сослаться на более знаковые в этом направлении статьи}\cite{Coulson}, \cite{Persis}, хотя в этом направлении продвижение не столь велико.

Цель настоящей работы --- исследование задачи робастного оптимального управления линейным стационарным динамическим объектом по неточным измерениям выходных сигналов и при наличии ограничений, в формулировке которой собственно модель в явном виде отсутствует, а динамика объекта неявно задается данными априорного наблюдения. При наличии модели объекта аналогичная задача (для непрерывных систем) исследовалась в работе \cite{Dmitruk2004}, где в режиме реального времени строятся реализации оптимальной обратной связи по измерениям на основе решения ряда задач оптимального наблюдения и управления. Разделимость процесса на наблюдение и управление в рамках подхода на основе данных составляет один из центральных результатов настоящей работы.



\section{Постановка задачи при наличии модели системы}\label{model-based problem}
Рассмотрим линейную дискретную стационарную систему $G$, минимальная реализация  $(A,B,C,D)$ которой известна:
\begin{equation}
    x(t+1) = Ax(t) + Bu(t),  \label{model}
    \end{equation}
$$
    y(t) = Cx(t) + Du(t),
    $$
$$
    t = 0, \ldots, T-1.
    $$
Здесь $x(t) \in \mathbb{R}^n$, $u(t) \in \mathbb{R}^m$, $y(t) \in \mathbb{R}^p$ --- состояние системы, управление и выходной сигнал в момент времени $t$, соответственно.

Траекторией системы $G$ будем называть пару $\{u, y\} = \{u(t), y(t)\}_{t=0}^{T-1}$ из управления и выходного сигнала,  удовлетворяющую (\ref{model}) при некотором (наблюдателю неизвестном) начальном состоянии $x(0) = x_0\in \mathbb{R}^n$.
%Вместо $$\{u(t), y(t)\}_{t=0}^{T-1} = \{(u(0), u(1), \ldots, u(T-1)), (y(0), y(1), \ldots, y(T-1))\},$$ будем зачастую пользоваться более лаконичной записью $\{u_T, y_T\}.$

Относительно начального состояния $x_0$ будем предполагать, что информация о нем ограничивается включением $x_0 \in X_0 = \{ x\in \mathbb{R}^n : x_{\min} \leq x \leq x_{\max} \}$.


На траекторию $\{u,y\}$ наложены следующие ограничения:
\begin{equation} \label{constraints}
    u(t) \in U, \quad y(t) \in Y(t), \quad t = 0, \ldots, T-1,
    \end{equation}
где множество доступных значений управления $U$ и множество допустимых выходных сигналов $Y(t)$ имеют вид $ U = \{u \in \mathbb{R}^m\ : u_{\min} \leq u \leq u_{\max} \}$, $Y(t) = \{ y \in \mathbb{R}^p : G(t)y \leq g(t) \},$ $G(t) \in \mathbb{R}^{q \times p}$, $g(t) \in \mathbb{R}^q$, $t = 0, \ldots, T-1$.

Поставим задачу о минимизации следующего квадратичного критерия качества
\begin{equation}\label{cost}
    J(u) = \sum\limits_{t = 0}^{T-1} \norm{u(t)}^2
    \end{equation}
на множестве доступных управляющих воздействий ${u(t) \in U}$, гарантирующих выполнение ограничений на выходные сигналы (\ref{constraints}) при всех возможных реализациях начального состояния $x_0 \in X_0$. Поставленная задача решается до начала процесса управления и позволяет дать априорную оценку (\ref{cost}) качества этого процесса.




В каждом конкретном процессе управления реализуется некоторая  траектория $\{u^p, y^p\}$, которая определяется  (неизвестным) начальным состоянием $x_0$ и поданным на вход системы  (\ref{model}) управлением $u^p = \{u^p(t)\}_{t=0}^{T-1}$. Далее будем считать, что в процессе управления доступны лишь неточные измерения выходных сигналов вида
$$
    \tilde{y}^p(t) = y^p(t) + \xi(t), \ \  t = 0, \ldots, T - 1,
     $$
где $\xi(t)$ --- ограниченная ошибка измерения в момент времени ${t = 0, \ldots, T -1}$.
%Верхний индекс $p$ подчеркивает, что измеренные сигналы относятся к конкретной "прошлой"\ (past) траектории.
Величина ошибка $\xi(t)$ достоверно неизвестна, однако полагаем ее в дальнейшем принадлежащей известному множеству: $\xi(t) \in \Xi = \{ \xi \in \mathbb{R}^p : \norm{\xi}_{\infty} \leq \varepsilon \}$.


{\color{red} К некоторому моменту времени $\tau$ пара $\{u^p_\tau, \tilde y^p_\tau\} = \{u^p(t), \tilde y^p(t)\}_{t=0}^{\tau-1}$ из реализовавшихся в рассматриваемом процессе управления и измерений составляет текущую позицию процесса. Она позволяет уточнить начальное состояние и улучшить априорную оценку качества процесса управления (\ref{cost}), \textcolor{blue}{в частности, посредством решения следующей задачи:}}

\begin{equation}\label{oc-at-tau}
    \min\limits_u \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,
    \end{equation}
$$ 
    x(t+1) = Ax(t) + Bu(t),
    $$
$$ 
    y(t) = Cx(t) + Du(t),
    $$
$$
    u(t) \in U, \quad 
    y(t) \in Y(t) \quad \forall x(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
$$
    t = \tau, \ldots, T-1,
    $$
{\color{blue} где $X(\tau, u_\tau^p, \tilde{y}_\tau^p)$ --- множество всех состояний $x(\tau)$, согласующихся с наблюдаемой траекторией $\{u_{\tau}^p, \tilde y_{\tau}^p\}$, т.е. таких, что из некоторого допустимого начального состояния $x_0 \in X_0$ под воздействием управления $u_{\tau}^p$ система приходит в $x(\tau)$; при этом соответствующая выходная траектория отличается от $\tilde y_{\tau}^p$ на допустимую ошибку.

Пусть $u^*(t|\tau, u_\tau^p, \tilde{y}_\tau^p), t = \tau, \ldots, T-1$, --- оптимальное управление в задаче (\ref{oc-at-tau}). Тогда в момент $\tau$ подаем на вход лишь первое значение 
$$
    u^p(\tau) = u^*(\tau|\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
после чего переходим к следующей задаче оптимального программного управления (\ref{oc-at-tau}), сформулированной уже в момент $\tau + 1$, на единицу уменьшившимся горизонтом планирования и обогатившимся знанием о поведении системы в лице более длинной траектории $\{u_{\tau+1}^p, \tilde{y}_{\tau+1}^p\}.$}

Один из возможных методов решения задачи (\ref{oc-at-tau}) , использующий принцип разделения процессов управления и наблюдения(см., к примеру, \cite{SeparationPrinciple}), предложен в \cite{Dmitruk2004}. Ознакомиться с ним можно в Приложении к данной работе.


\section{Задача в отсутствие модели системы}
Далее сосредоточимся на задаче управления системой $G$, однако условимся, что реализация $(A,B,C,D)$ системы в пространстве состояний не известна. Классический подход в подобных ситуациях состоит в предварительной идентификации системы и последующей формулировке и решении задачи из разд. 2.

В настоящей работе будет предложен альтернативный подход, не нуждающийся в явном параметрическом представлении системы вовсе. Вместо модели $(A,B,C,D)$ будем использовать полученное в \cite{BerberichAllgower} представление любой траектории системы $G$ на основе одной предварительно сгенерированной траектории
$$
    \{u^d, y^d\} = \{u^d(t), y^d(t)\}_{t = 0}^{T^d - 1},
     $$
которую далее будем называть априорной траекторией.


Будем считать, что  априорная траектория $\{u^d, y^d\}$ известна точно, а также, как и в работе \cite{BerberichAllgower}, для системы $G$ дана верхняя оценка размерности ее состояния $n$.

%Как и ранее,  траектории "прошлого"\ $${\{(u^p(0), u^p(1), \ldots, u^p(\tau-1)), (y^p(0), y^p(1), \ldots, y^p(\tau-1))\} = \{u_\tau^p, y_\tau^p \}},$$ известные к текущему моменту $\tau$ в процессе управления системой, будем считать измеренными с точностью до ограниченной ошибки: т.е. доступны лишь $\{u_\tau^p, \tilde{y}_\tau^p\}$, где ${\tilde{y}^p_\tau = y^p_\tau + \xi_\tau}$.
%
%В текущий момент времени $\tau$, подобно предыдущему разделу, ставится задача минимизации квадратичного критерия качества
%$$
%    \sum_{t = \tau}^{T-1} \norm{u(t)}^2,
%    $$
%при гарантированном соблюдении линейных условий
%$$
%    G(t)y(t) \leq g(t), \quad u_{\min} \leq u(t) \leq u_{\max}, \quad \tau \leq t \leq T-1,
%    $$
%на входные и выходные сигналы.


\subsection{Информативность априорной траектории}
Покажем, как априорная траектория $\{u^d, y^d\}$ при определенных условиях может иметь ту же информационную ценность, что и модель системы $(A,B,C,D)$, в случае ее наличия. Воспользуемся некоторыми результатами бихевиористской теории.

\begin{definition}\label{persistency exciting}
{\color{red} Давайте $t$ на $L$ заменим??}{\color{blue} Чтобы t зарезервировано было для ситуаций, когда время у нас бегает (индексы суммирования и все такое)? Согласна, заменила} Пусть $L,T \in \mathbb{Z}_{ \geq 0}$, $T \geq L$. Управление {\color{blue} $u = \{u(t)\}_{t=0}^{T-1} \in \mathbb{R}^{mT}$} называется постоянно возбуждающим порядка $L$, если соответствующая матрица Ганкеля
$$
H_L(u) =
\begin{pmatrix}
  u(0) & u(1) & \cdots & u(T-L)\\
  u(1) & u(2) & \cdots & u(T-L+1)\\
  \vdots & \vdots & \ddots & \vdots \\
  u(L-1) & u(L) & \cdots & u(T-1)
\end{pmatrix}
$$
имеет полный строчный ранг.
\end{definition}

\begin{remark}\label{remark on input length}
Если управление $u$ является постоянно возбуждающим порядка $L$, то оно должно быть достаточно длинным. Поскольку матрица имеет полный строчный ранг, число строк не   превышает число столбцов: $T - L + 1 \geq mL$. Отсюда следует необходимое условие на длину $T$ постоянно возбуждающего управления порядка $L$: $T \geq L(m+1) - 1,$ где $m$~--- размерность входа.
\end{remark}

Согласно \cite{Willems}, \cite{BerberichAllgower}, траектория, порожденная постоянно возбуждающим управлением достаточно высокого порядка, содержат информацию, достаточную для представления любой траектории системы $G$. Далее будем использовать следующий результат работы \cite{Willems}, сформулированный в \cite{BerberichAllgower} в терминах  классических моделей в пространстве состояний:
\begin{theorem}\label{trajectory check}
Пусть $\{u^d, y^d\}$ --- траектория линейной системы $G$ размерности $n$, причем $u^d$ --- постоянно возбуждающее управление порядка $T+n$. Тогда $\{u, y\} = \{u(t), y(t)\}_{t=0}^{T-1}$ является траекторией $G$ в том и только в том случае, когда для
\begin{equation}
\begin{pmatrix}
H_T(u^d) \\
H_T(y^d)
\end{pmatrix} \alpha = \begin{pmatrix}
u \\
y
\end{pmatrix}
\end{equation}
существует решение $\alpha \in \mathbb{R}^{T^d-T+1}.$
\end{theorem}

Теорема \ref{trajectory check} позволяет проверять любую траекторию длины $T$ на принадлежность множеству траекторий системы $G$. {\color{red} Тут не совсем понятно: это же достаточная часть теоремы}{\color{blue} Вроде бы условие существования $\alpha$ достаточное всегда, но поскольку у нас постоянно возбуждающее управление $u^d$ --- оно еще и необходимое} В рассматриваемом случае стоит обратная задача: чтобы определить, допустимо ли конкретное управление в конкретный момент времени, хотелось бы уметь в некотором смысле симулировать систему.

{\color{red} Почему модификацию?} {\color{blue} просто теорему, да} При определенных условиях теорему \ref{trajectory check} можно использовать для генерации множества возможных траекторий $\{u^p_\tau, u, y^p_\tau, y\}$ длины $T$ с некоторой фиксированной "прошлой"\ частью $\{u^p_\tau, y^p_\tau\}$ длины $\tau$. Нефиксированную часть $\{u, y\} = \{u(t), y(t)\}_{t=\tau}^{T-1}$ будем называть "будущей"\ частью траектории. Соответственно, будем делить на "прошлое"\ и "будущее"\ для момента $\tau$ и строки матриц Ганкеля для априорной траектории:
\begin{equation}
H_T(u^d) = \begin{pmatrix}
  u^d(0) & \cdots & u^d(T^d-T)\\
  \vdots & \ddots & \vdots \\
  u^d(\tau-1) & \cdots & u^d(\tau-1 + T^d - T) \\
  \hline
  u^d(\tau) & \cdots & u^d(\tau + T^d-T)\\
  \vdots & \ddots & \vdots \\
  u^d(T-1) & \cdots & u^d(T^d-1)
\end{pmatrix} =
		\begin{pmatrix}
		U_{\tau}^p \\
		U_{\tau}^f
		\end{pmatrix},
\end{equation}
\begin{equation}
H_T(y^d) = \begin{pmatrix}
  y^d(0) & \cdots & y^d(T^d-T)\\
  \vdots & \ddots & \vdots \\
  y^d(\tau-1) & \cdots & y^d(\tau-1 + T^d - T) \\
  \hline
  y^d(\tau) & \cdots & y^d(\tau + T^d-T)\\
  \vdots & \ddots & \vdots \\
  y^d(T-1) & \cdots & y^d(T^d-1)
\end{pmatrix} =
		\begin{pmatrix}
		Y_{\tau}^p \\
		Y_{\tau}^f
		\end{pmatrix}.
\end{equation}

%{\color{red} Нам это нужно для чего-то?} Поэтому для построения возможных траекторий можно воспользоваться следующим алгоритмом:\\
%1. Зафиксировать интересующее значение "будущего"\ входного сигнала $u$.\\
%2. Для выбранного $u$ найти некоторое решение $\alpha \in \mathbb{R}^{T^d-T+1}$ системы линейных алгебраических уравнений
%\begin{equation}
%\begin{pmatrix}
%U_{\tau}^p \\
%Y_{\tau}^p \\
%U_{\tau}^f
%\end{pmatrix} \alpha = \begin{pmatrix}
%u_{\tau}^p \\
%y_{\tau}^p \\
%u
%\end{pmatrix}.
%\end{equation}
%3. Вычислить $y = Y_{\tau}^f \alpha$. Получили одну из возможных
%траекторий для фиксированных $u^p_\tau, y^p_\tau, u$.

Если управление $u^d$ является постоянно возбуждающим порядка $T+n$, то, согласно теореме \ref{trajectory check}, $\{u_{\tau}^p, u, y_{\tau}^p, y\}$ является траекторией системы $G$ тогда и только тогда, когда уравнение
\begin{equation}\label{traj-cond}
\begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f \\
Y_{\tau}^f
\end{pmatrix} \alpha = \begin{pmatrix}
u_{\tau}^p \\
y_{\tau}^p \\
u \\
y
\end{pmatrix}
\end{equation}
имеет решение $\alpha \in \mathbb{R}^{T^d - T +1}$.

Именно в таком виде теорему \ref{trajectory check} будем использовать в следующием разделе.

END DOCUMENT WAS THERE (Этот кусок откорректированный Вы мне прислали)


%Вместо явного задания динамики системы моделью $(A,B,C,D)$ в пространстве состояний, будем пользоваться неявным описанием  поведения системы в виде (\ref{traj-cond}). Начальное состояние системы также фиксируем неявно, начиная управление в момент $n$.
%
%Таким образом, в каждый момент времени $n \leq \tau \leq T$ решаем следующую задачу оптимального программного управления, обладая неточной траекторией $\{u_\tau^p, \tilde{y}_\tau^p\}$:
%\begin{equation}\label{dd-oc-at-tau}
%\min\limits_{u} u^Tu,
%\end{equation}
%$$
%\begin{pmatrix}
%U_\tau^p \\
%Y_\tau^p \\
%U_\tau^f \\
%\end{pmatrix} \alpha = \begin{pmatrix}
%u_\tau^p \\
%y_\tau^p \\
%u \\
%\end{pmatrix},
%$$
%$$
%\tilde{y}_\tau^p = y_\tau^p + \xi_\tau, \quad -\varepsilon\mathbbm{1} \leq \xi_\tau \leq \varepsilon \mathbbm{1},
%$$
%$$u_{\min}(\tau) \leq u \leq u_{\max}(\tau),$$
%$$
%G_\tau Y_\tau^f \alpha \leq g_\tau \quad \forall \alpha, \xi_\tau,
%$$

\subsection{Принцип разделимости}
{\color{red} Предложение-переход плавный к новой секции добавить?}Продемонстрируем, как элегантно реализуется принцип разделимости в бихевиористском подходе.

\begin{lemma}\label{dd-separation}
Пусть $\{u_{\tau}^p, y_{\tau}^p \}$ --- некоторая фиксированная траектория системы $G$ длины $\tau \geq n$. Тогда любая траектория $\{u_{\tau}^p, u, y_{\tau}^p, y\}$ длины $T$ системы $G$ однозначно представима в виде суммы траекторий $\{0, u, 0, y_0\}$ и $\{u_{\tau}^p, 0, y_{\tau}^p, \hat{y}\}$ длины $T$, причем для фиксированного $u$ определить неизвестные участки $y_0, \hat{y}$ можно следующим образом:\\
1. Найти некоторые решения $\hat{\alpha}, \alpha_0$ алгебраичеких уравнений
\begin{equation}
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
\end{pmatrix} \hat{\alpha} = \begin{pmatrix}
u_\tau^p \\
y_\tau^p \\
0 \\
\end{pmatrix}, \quad
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
\end{pmatrix} \alpha_0 = \begin{pmatrix}
0 \\
0 \\
u \\
\end{pmatrix}.
\end{equation}
2. Вычислить $\hat{y} = Y_\tau^f\hat{\alpha}, \quad y_0 = Y_\tau^f\alpha_0$.
\end{lemma}
{\color{blue} Тут ощущение, что написанное докозательство воспринимается как-то рвано, но я уже этого не вижу замыленным взглядом}
\begin{proof}
Решения $\hat \alpha, \alpha_0$ в шаге 1 существуют --- в противном случае, согласно теореме \ref{trajectory check}, записанной в виде (\ref{traj-cond}), не существовало бы вовсе выходных траекторий для управлений $0, u$, примененных к состоянию, индуцированному начальной траекторией $\{u_{\tau}^p, y_{\tau}^p \}$.

Более того, в результате шага 2 получаем возможные выходные сигналы системы $\hat{y}, y_0$ для входных сигналов $0, u$ соответственно, поскольку 
\begin{equation}\label{two traj}
\begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f \\
Y_{\tau}^f
\end{pmatrix} \hat{\alpha} = \begin{pmatrix}
u_{\tau}^p \\
y_{\tau}^p \\
0 \\
\hat{y}
\end{pmatrix}, \quad
\begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f \\
Y_{\tau}^f
\end{pmatrix} \alpha_0 = \begin{pmatrix}
0 \\
0 \\
u \\
y_0
\end{pmatrix}.
\end{equation}

Единственность полученных $\hat{y}, y_0$ обеспечивается достаточно длинной траекторией $\{u_{\tau}^p, y_{\tau}^p\}$: поскольку ее длина $\tau$ не меньше размерности $n$ системы, начальное состояние определено однозначно.

Сложив два равенства в (\ref{two traj}), получим
\begin{equation}\label{one traj}
\begin{pmatrix}
U_{\tau}^p \\
Y_{\tau}^p \\
U_{\tau}^f \\
Y_{\tau}^f
\end{pmatrix} (\hat{\alpha} + \alpha_0) = \begin{pmatrix}
u_{\tau}^p \\
y_{\tau}^p \\
u \\
\hat{y} + y_0
\end{pmatrix}.
\end{equation}

В силу теоремы \ref{trajectory check}, $\{u_{\tau}^p, u, y_{\tau}^p, \hat{y} + y_0\}$ --- траектория системы. Поскольку начальное состояние $x_0$ неявно зафиксировано достаточно длинным участком $\{u_{\tau}^p, y_{\tau}^p\}$, эта траектория совпадает с искомой $\{u_{\tau}^p, u, y_{\tau}^p, y\}$, т.е. $y = \hat{y} + y_0$.
 $\Box$
\end{proof}

\begin{remark}
Нетрудно убедиться, что $\hat{y}$ соответствует выходной траектории неуправляемой с момента $\tau$ системы, а $y_0$ ---  выходному сигналу номинальной системы из нулевого состояния в момент $\tau$. Здесь нулевое состояние в момент $\tau$  неявно задают $\{u_\tau^p, y_\tau^p\} = \{0, 0\}$ --- именно такую траекторию имеет система с нулевым начальным состоянием, а значит, и с нулевым состоянием в момент $ \tau$; с другой стороны, $\tau \geq n$ обеспечивает единственность этой траектории. 
\end{remark}

\begin{remark}
Чтобы Лемма \ref{dd-separation} была применима, в дальнейшем полагаем, что управление начинается в момент $n$, --- это своего рода неявный аналог явного ограничения $x_0 \in X_0$ в постановке задачи при известной модели.
\end{remark}

В связи с вышеизложенным, ограничение на выходные сигналы принимает вид
$G_{\tau}(y_0+\hat{y}) \leq g_{\tau}$,
где матрица
\[
G_\tau =
\begin{pmatrix}
  \begin{matrix}
  G(\tau)
  \end{matrix}
  & \rvline & \bigzero & \rvline & \cdots & \rvline & \bigzero\\
\hline
  \bigzero & \rvline &
  \begin{matrix}
    G(\tau + 1)
  \end{matrix}
  & \rvline & \cdots  & \rvline & \bigzero \\
\hline
  \vdots & \rvline & \vdots & \rvline &
  \begin{matrix}
    \ddots
  \end{matrix}
  & \rvline & \bigzero \\
\hline
  \bigzero & \rvline & \bigzero & \rvline & \bigzero & \rvline &
  \begin{matrix}
    G(T-1)
  \end{matrix}
\end{pmatrix},
\]
вектор $g_{\tau} = (g(\tau), g(\tau+1), \cdots, g(T-1)).$ 

Наложим на $y_0$ суженное условие:
\begin{equation}\label{tightened constraint}
G_{\tau}y_0 \leq g_{\tau}-\chi(\tau),
\end{equation}
где каждая компонента $\chi_i(\tau)$ соответствует наихудшей реализации состояния системы в момент $\tau$, а именно является решением задачи линейного программирования
\begin{equation} \label{estimation}
\chi_i(\tau) = \max\limits_{\hat{\alpha}, \xi_{\tau}, \hat{y}} G_{\tau i}\hat{y},
\end{equation}
$$\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
Y_\tau^f \\
\end{pmatrix} \hat{\alpha} = \begin{pmatrix}
u_\tau^p \\
\tilde{y}_\tau^p + \xi_{\tau}\\
0 \\
\hat{y}\\
\end{pmatrix},
$$
$$-\varepsilon \mathbbm{1} \leq \xi_{\tau} \leq \varepsilon \mathbbm{1}.$$

Здесь и далее $\mathbbm{1}$ обозначает единичный вектор, размерность которого понятна из контекста.

Задача (\ref{estimation}) в компактной формулировке (исключается $\xi_{\tau}$) имеет вид
\begin{equation} \label{estimation-lp}
\chi_i(\tau) = \max\limits_{\hat{\alpha}} G_{\tau i}Y_{\tau}^f\hat{\alpha},
\end{equation}
$$\begin{pmatrix}
U_\tau^p \\
U_\tau^f \\
\end{pmatrix} \hat{\alpha} = \begin{pmatrix}
u_\tau^p \\
0 \\
\end{pmatrix},
$$
$$
\tilde{y}_{\tau}^p-\varepsilon \mathbbm{1} \leq
Y_\tau^p \hat{\alpha} \leq
\tilde{y}_\tau^p + \varepsilon \mathbbm{1}.
$$
Выполнение  для $y_0$ суженного ограничения (\ref{tightened constraint}) очевидно влечет удовлетворение исходного ограничения на $y$ для любой возможной реализации $\hat{y}$.

Детерминированная задача оптимального программного управления с суженными условиями на $y_0$ принимает следующий вид:

\begin{equation}\label{control}
\min\limits_{\alpha_0, u, y_0}u^Tu,
\end{equation}
$$\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
Y_\tau^f \\
\end{pmatrix} \alpha_0 = \begin{pmatrix}
0 \\
0 \\
u \\
y_0 \\
\end{pmatrix},$$
$$G_{\tau}y_0 \leq g_{\tau} - \chi(\tau),$$
$$u_{\min}(\tau) \leq u \leq u_{\max}(\tau),$$
где $u_{\min}(\tau) = (\underbrace{u_{\min}, \ldots, u_{\min}}_{T - \tau \textup{ раз}}), \quad u_{\max}(\tau) = (\underbrace{u_{\max}, \ldots, u_{\max}}_{T - \tau \textup{ раз}}).$

Снова переходим к эквивалентному, но более компактному виду, получаем
\begin{equation}\label{control-qp}
\min\limits_{\alpha_0}\alpha_0^T{U_{\tau}^f}^TU_{\tau}^f\alpha_0,
\end{equation}
$$
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
\end{pmatrix} \alpha_0 = \begin{pmatrix}
0 \\
0 \\
\end{pmatrix},
$$
$$G_{\tau}Y_{\tau}^f\alpha_0 \leq g_{\tau} - \chi(\tau),$$
$$u_{\min}(\tau) \leq U_{\tau}^f\alpha_0 \leq u_{\max}(\tau).$$
Получив решение $\alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)$ задачи  (\ref{control-qp}), вычисляем оптимальное управление ${u^*(\tau, u_\tau^p, \tilde{y}_\tau^p) = U_\tau^f \alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)}$. Из вычисленного ${u^*(\tau, u_\tau^p, \tilde{y}_\tau^p) = (u^*(\tau|\tau, u_\tau^p, \tilde{y}_\tau^p), \ldots, u^*(T-1|\tau, u_\tau^p, \tilde{y}_\tau^p))}$ подаем на вход системе ${u^p(\tau) := u^*(\tau|\tau, u_\tau^p, \tilde{y}_\tau^p).}$ Переходим к решению задач (\ref{estimation-lp}), а затем и задачи (\ref{control-qp}), в момент $\tau+1$, зная траекторию $\{u^p_{\tau+1}, \tilde{y}^p_{\tau+1}\}$. Если существовало допустимое воздействие в момент $\tau$, то гарантированно существует допустимое воздействие в момент $\tau + 1$, причем значение критерия качества на каждом шагу не увеличивается.

\bigskip
Таким образом, задача оптимального управления, решаемая в каждой временной точке $n \leq \tau \leq T-1$, свелась к ряду задач линейного программирования и одной выпуклой задаче квадратичного программирования.

\section{Недетерминированный случай: априорные измерения неточны}
В этом разделе будет кратко приведена идея развития результатов.
Интерес представляет случай, когда и априорные измерения содержат некоторую ошибку, т.е. $\tilde{y}^d = y^d + \xi^d.$


Тогда $\tilde{Y}_{\tau}^p = Y_{\tau}^p + \mathit{\Xi}_{\tau}^p$,
$\tilde{Y}_{\tau}^f = Y_{\tau}^f + \mathit{\Xi}_{\tau}^f$, где
$$
\begin{pmatrix}
		\mathit{\Xi}_{\tau}^p\\
		\mathit{\Xi}_{\tau}^f
		\end{pmatrix}  = \begin{pmatrix}
  \xi(0) & \cdots & \xi(T^d-T)\\
  \vdots & \ddots & \vdots \\
  \xi(\tau-1) & \cdots & \xi(\tau - 1 + T^d-T) \\
  \hline
  \xi(\tau) & \cdots & \xi(\tau + T^d-T)\\
  \vdots & \ddots & \vdots \\
  \xi(T-1) & \cdots & \xi(T^d-1)
\end{pmatrix}
    = H_T(\xi^d).
$$

В соответствии с этим задача оптимального оценивания (\ref{estimation}) перепишется следующим образом:

\begin{equation} \label{estimation-noisy}
\chi_i(\tau) = \max\limits_{\hat{\alpha}, \xi_{\tau}, \xi^d} G_{\tau i}\hat{y},
\end{equation}
$$\begin{pmatrix}
U_\tau^p \\
Y_\tau^p + \mathit{\Xi}_\tau^p\\
U_\tau^f \\
Y_\tau^f + \mathit{\Xi}_\tau^f \\
\end{pmatrix} \hat{\alpha} = \begin{pmatrix}
u_\tau^p \\
\tilde{y}_\tau^p + \xi_{\tau}\\
0 \\
\hat{y}\\
\end{pmatrix},
$$
$$-\varepsilon \mathbbm{1} \leq \xi_{\tau} \leq \varepsilon \mathbbm{1},$$
$$-\varepsilon \mathbbm{1} \leq \xi^d \leq \varepsilon \mathbbm{1}.$$

Задача (\ref{estimation-noisy}) представяет собой задачу с квадратичной целевой функцией и квадратичными ограничениями относительно переменной $(\hat{\alpha}, \xi^d)$. Сложность заключается в том, данная задача является невыпуклой. В дальнейшем было бы интересно исследовать эффективные способы решения этой невыпуклой задачи оптимального оценивания. Впоследствии можно использовать этот результат для решения соответствующей задачи оптимального управления в условии неточной априорной траектории.

\section{Численный пример}
Применим изложенный метод для управления следующей системой размерности $n = 3$ с одним входом и одним выходом:
$$x(t+1) = \begin{pmatrix}
0.8639 & 0.3075 & -0.2086 \\
-0.146 & 0.9265 & 0.245 \\
-0.1715 & -0.2195 & 1\\
\end{pmatrix}
x(t) + \begin{pmatrix}
0.1239 \\
-0.0847 \\
0.1602\\
\end{pmatrix}u(t),$$
$$y(t) = \begin{pmatrix}
0.3 & 1.5 & -0.7 \\
\end{pmatrix}x(t) + \begin{pmatrix}
-1.4
\end{pmatrix}u(t), \quad t= 0, \ldots, T-1,$$
минимизируя критерий качества $\sum_{t=0}^{T-1}\norm{u(t)}^2$ при гарантированном соблюдении ограничений $-1 \leq u(t) \leq 1, \quad -1 \leq y(t) \leq 1, \quad t = n, \ldots, T-1.$
Момент начала управления такой же, как и размерность системы $n = 3$ --- этого достаточно для неявного задания начального условия $x_0.$ Горизонт планирования $T = 120.$

Как было отмечено в Замечании \ref{lower bound on T^d}, длина априорной траектории $T^d$ должна быть не меньше $(n + T)(m + 1) - 1$, что в нашем случае, при $n = 3, m = 1$, означает $T^d \geq 2(3+T) - 1 = 245.$ Именно такой, наименьшей подходящей длины, была предварительно сгенерирована зашумленная траектория $\{u^d, \tilde{y}^d\}.$ Входные сигналы были сгенерированы как случайные числа, равномерно распределенные в $[-1, 1]$, а ошибки, добавляемые к "чистой"\ выходной траектории $y^d$, --- как случайные числа, равномерно распределенные в $[-\varepsilon, \varepsilon], \quad \varepsilon = 0.002.$

После таким же образом была сгенерирована траектория $\{u^p_3, \tilde{y}^p_3\}$, соответствующая движению системы до начала управления:
$$u_3^p = \begin{pmatrix}
   0.11004849  \\
   0.59704522  \\
   0.43059520
\end{pmatrix},
y_3^p = \begin{pmatrix}
  0.70244403  \\
  -0.07057178 \\
   0.07171414
\end{pmatrix}.
$$
Ниже приведены управление, выход и фазовая траектория, полученные в результате применения предложенного метода.

\begin{figure}[H]
\centering
\includegraphics[scale = 0.9]{ufinal.eps}
\caption{\ }
\end{figure}
Значение критерия качества составляет $2.84904042$ на первой итерации, $2.60124510$ --- на последней.

\begin{figure}[H]
\centering
\includegraphics[scale = 0.9]{yfinal.eps}
\caption{\ }
\end{figure}

На рис. \ref{phase} точкой $\circ$ отмечено начальное положение, а звездочкой *~--- конечное положение траектории.
\begin{figure}[H]
\centering
\includegraphics[scale= 0.9]{xfinal.eps}
\caption{\ }
\label{phase}
\end{figure}


\section{Заключение}
В данной работе был предложен новый способ решения задачи оптимального управления линейной стационарной системой по неточным выходным сигналам при гарантированном соблюдении наложенных на выходные сигналы ограничений. Этот способ не требует знания реализации системы в пространстве состояний. Предложенный метод сводится к решению задач линейного и квадратичного программирования, базирующихся лишь на двух траекториях системы: априорной и наблюдаемой в процессе управления.

Задача решена в предположении, что траектория, измеряемая в процессе управления, неточна, но априорная траектория известна точно. Было предложено дальнейшее направление исследования: случай, когда априорная траектория также зашумлена.

\appendix{}
Метод решения задачи (\ref{oc-at-tau}) из раздела \ref{model-based problem}, предложенный в \cite{Dmitruk2004}

Итак, в каждый момент времени $\tau = 0, \ldots, T-1$, обладая знанием неточной траектории $\{u_\tau^p, \tilde{y}_\tau^p\}$,  решаем следующую задачу оптимального программного управления:
\begin{equation}\label{oc-at-tau-app}
    \min\limits_u \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,
    \end{equation}
$$
    x(t+1) = Ax(t) + Bu(t),
    $$
$$
    y(t) = Cx(t) + Du(t),
    $$
$$
    u(t) \in U, \quad
    y(t) \in Y(t) \quad \forall x(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
$$
    t = \tau, \ldots, T-1.
    $$

Воспользовавшись принципом разделимости процессов управления и наблюдения для линейных систем, разделяем решение задачи (\ref{oc-at-tau-app}) на решение ряда задач оптимального наблюдения и одной задачи детерминированного оптимального управления.

Так, представив состояние $x(t)$ и выходной сигнал $y(t)$ в виде $x(t) = x_0(t) + \hat{x}(t),$ $y(t) = y_0(t) + \hat{y}(t)$, где $x_0(t), y_0(t)$ соответствуют состоянию и выходу номинальной системы с тривиальным начальным состоянием
$$
    x_0(t+1) = Ax_0(t) + Bu(t), \quad x_0(\tau) = 0,
    $$
$$
    y_0(t) = Cx_0(t) + Du(t), \quad t = \tau, \ldots, T-1,
    $$
а $\hat{x}(t), \hat{y}(t)$ соответствуют состоянию и выходу неуправляемой системы с неопределенным начальным состоянием
$$
    \hat{x}(t) = A\hat{x}(t), \quad \hat{x}(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
$$
    \hat{y}(t) = C\hat{x}(t), \quad t = \tau, \ldots, T-1,
    $$
можем рассмотреть ограничение на выходные сигналы (\ref{constraints}) в виде
$$
    G(t)(y_0(t) + \hat{y}(t)) \leq g(t), \quad \forall x(\tau) \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
что влечет естественное суженное условие на $y_0(t)$, удовлетворение которого будет гарантировать допустимость выходного сигнала $y(t)$:
\begin{equation}\label{model-chi}
    y_0(t) \in Y_0(t | \tau) = \{y \in \mathbb{R}^p : G(t)y \leq g(t) - \chi(t|\tau)\},
    \end{equation}
где каждая компонента вектора $\chi(t | \tau)$ соответствет наихудшей реализации состояния $x(\tau)$:
\begin{equation}
    \chi_i(t | \tau) = \max\limits_z G_i(t)\hat{y}(t),
    \end{equation}
$$
    \hat{x}(s+1) = A\hat{x}(s), \quad \hat{x}(\tau) = z,
    $$
$$
    y(s) = C\hat{x}(s), \quad s = \tau, \ldots, t,
    $$
$$
    z \in X(\tau, u_\tau^p, \tilde{y}_\tau^p),
    $$
где $G_i(t)$ обозначает $i$--ю строку матрицы $G(t).$

После вычисления всех оценок $\chi(t|\tau), \quad t = \tau, \ldots, T-1$, оптимальное управление $u^*(t|\tau, u_\tau^p, \tilde{y}_\tau^p)$ получаем как решение следующей детерминированной задачи оптимального управления:
\begin{equation}\label{model-det-oc}
\min\limits_u \sum\limits_{t = \tau}^{T-1} \norm{u(t)}^2,
\end{equation}
$$
    x_0(t+1) = Ax_0(t) + Bu(t), \quad x_0(\tau) = 0,
    $$
$$
    y_0(t) = Cx_0(t) + Du(t),
    $$
$$
    u(t) \in U, \quad y_0(t) \in Y_0(t | \tau),
    $$
$$
    t = \tau, \ldots, T-1.
    $$

\begin{thebibliography}{10}
\bibitem{Dmitruk2004}
{\it Габасов Р., Дмитрук Н.М., Кириллова Ф.М.} Оптимальное управление многомерными системами по неточным измерениям их выходных сигналов // Труды Института математики и механики УрО РАН. 2004  Т. 10. № 2. С. 33--57.

\bibitem{BerberichAllgower}
{\it Berberich J., Allg{\"o}wer F.} A trajectory-based framework for data-driven system analysis and control //
arXiv: 1903.10723. 2019.

\bibitem{BerberichRobust}
{\it Berberich J., Romer A., Scherer C. W., Allg{\"o}wer F.} Robust data-driven state-feedback design //
arXiv: 1909.04314. 2019.

\bibitem{BerberichMPC}
{\it Berberich J., K{\"o}hler J., M{\"u}ller M. A., Allg{\"o}wer F.} Data-Driven Model Predictive Control with Stability and Robustness Guarantees //
arXiv: 1906.04679. 2019.

\bibitem{Copp}
{\it Copp D., Hespanha J.} Simultaneous nonlinear model predictive control and state estimation //
Automatica. 2016. V. 77. P. 143--154.

\bibitem{Coulson}
{\it Coulson J., Lygeros J., D{\"o}rfler F.} Data-Enabled Predictive Control: In the Shallows of the DeePC //
18th European Control Conference (ECC), Naples, Italy. 2019. P. 307--312.

\bibitem{SeparationPrinciple}
{\it Kurzhanskii A. B., V\'{a}lyi I.}
Ellipsoidal calculus for estimation and control. Nelson Thornes, 1997

\bibitem{Persis}
{\it De Persis C., Tesi P.} Formulas for data--driven control: Stabilization, optimality and robustness //
arXiv: 1903.06842. 2019.

\bibitem{Romer}
{\it Romer A., Berberich J., K{\"o}hler J., Allg{\"o}wer F.} One--shot verification of dissipativity properties from input--output data //
IEEE Control Systems Letters. 2019. V. 3, No.3. P. 709--714.

\bibitem{Waarde}
{\it Waarde H. J., Eising J., Trentelman H. L., Camlibel M. K.} Data informativity: a new perspective on data-driven analysis and control //
arXiv: 1908.00468. 2019.

\bibitem{Willems}
{\it Willems J. C., Markovsky I., Rapisarda P., De Moor B. L. M.} A note on persistency of excitation //
Systems \& Control Letters. 2005. V.54. P. 325--329.

\bibitem{WillemsPuzzles}
{\it Willems J. C.} Paradigms and puzzles in the theory of dynamical systems //
IEEE Transactions on Automatic Control. 1991. V.36, No 3. P.259--294.
\end{thebibliography}

\AdditionalInformation{Дмитрук Н.М.}{место
работы, должность, Минск}{dmitrukn@bsu.by}

\AdditionalInformation{Манжулина Е.А.}{место
работы, должность, Минск}{fpm.manzhuli@bsu.by}


\end{document}
